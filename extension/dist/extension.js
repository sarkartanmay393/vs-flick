"use strict";var zi=Object.create;var ft=Object.defineProperty;var Yi=Object.getOwnPropertyDescriptor;var Xi=Object.getOwnPropertyNames;var Ki=Object.getPrototypeOf,Ji=Object.prototype.hasOwnProperty;var S=(s,e)=>()=>(e||s((e={exports:{}}).exports,e),e.exports),As=(s,e)=>{for(var t in e)ft(s,t,{get:e[t],enumerable:!0})},Bs=(s,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Xi(e))!Ji.call(s,i)&&i!==t&&ft(s,i,{get:()=>e[i],enumerable:!(r=Yi(e,i))||r.enumerable});return s};var x=(s,e,t)=>(t=s!=null?zi(Ki(s)):{},Bs(e||!s||!s.__esModule?ft(t,"default",{value:s,enumerable:!0}):t,s)),Qi=s=>Bs(ft({},"__esModule",{value:!0}),s);var Fs=S((La,Ds)=>{var Se=require("fs"),Ps=require("url"),Zi=require("child_process").spawn;Ds.exports=$t;$t.XMLHttpRequest=$t;function $t(s){"use strict";s=s||{};var e=this,t=require("http"),r=require("https"),i,n,o={},a=!1,c={"User-Agent":"node-XMLHttpRequest",Accept:"*/*"},h=Object.assign({},c),f=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","content-transfer-encoding","cookie","cookie2","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"],l=["TRACE","TRACK","CONNECT"],d=!1,_=!1,y=!1,p={};this.UNSENT=0,this.OPENED=1,this.HEADERS_RECEIVED=2,this.LOADING=3,this.DONE=4,this.readyState=this.UNSENT,this.onreadystatechange=null,this.responseText="",this.responseXML="",this.response=Buffer.alloc(0),this.status=null,this.statusText=null;var E=function(u){return a||u&&f.indexOf(u.toLowerCase())===-1},L=function(u){return u&&l.indexOf(u)===-1};this.open=function(u,m,A,C,M){if(this.abort(),_=!1,y=!1,!L(u))throw new Error("SecurityError: Request method not allowed");o={method:u,url:m.toString(),async:typeof A!="boolean"?!0:A,user:C||null,password:M||null},w(this.OPENED)},this.setDisableHeaderCheck=function(u){a=u},this.setRequestHeader=function(u,m){if(this.readyState!=this.OPENED)throw new Error("INVALID_STATE_ERR: setRequestHeader can only be called when state is OPEN");if(!E(u))return console.warn('Refused to set unsafe header "'+u+'"'),!1;if(d)throw new Error("INVALID_STATE_ERR: send flag is true");return h[u]=m,!0},this.getResponseHeader=function(u){return typeof u=="string"&&this.readyState>this.OPENED&&n.headers[u.toLowerCase()]&&!_?n.headers[u.toLowerCase()]:null},this.getAllResponseHeaders=function(){if(this.readyState<this.HEADERS_RECEIVED||_)return"";var u="";for(var m in n.headers)m!=="set-cookie"&&m!=="set-cookie2"&&(u+=m+": "+n.headers[m]+`\r
`);return u.substr(0,u.length-2)},this.getRequestHeader=function(u){return typeof u=="string"&&h[u]?h[u]:""},this.send=function(u){if(this.readyState!=this.OPENED)throw new Error("INVALID_STATE_ERR: connection must be opened before send() is called");if(d)throw new Error("INVALID_STATE_ERR: send has already been called");var m=!1,A=!1,C=Ps.parse(o.url),M;switch(C.protocol){case"https:":m=!0;case"http:":M=C.hostname;break;case"file:":A=!0;break;case void 0:case"":M="localhost";break;default:throw new Error("Protocol not supported.")}if(A){if(o.method!=="GET")throw new Error("XMLHttpRequest: Only GET method is supported");if(o.async)Se.readFile(unescape(C.pathname),function(B,ue){B?e.handleError(B,B.errno||-1):(e.status=200,e.responseText=ue.toString("utf8"),e.response=ue,w(e.DONE))});else try{this.response=Se.readFileSync(unescape(C.pathname)),this.responseText=this.response.toString("utf8"),this.status=200,w(e.DONE)}catch(B){this.handleError(B,B.errno||-1)}return}var J=C.port||(m?443:80),le=C.pathname+(C.search?C.search:"");if(h.Host=M,m&&J===443||J===80||(h.Host+=":"+C.port),o.user){typeof o.password>"u"&&(o.password="");var Mt=new Buffer(o.user+":"+o.password);h.Authorization="Basic "+Mt.toString("base64")}if(o.method==="GET"||o.method==="HEAD")u=null;else if(u){h["Content-Length"]=Buffer.isBuffer(u)?u.length:Buffer.byteLength(u);var Wi=Object.keys(h);Wi.some(function(B){return B.toLowerCase()==="content-type"})||(h["Content-Type"]="text/plain;charset=UTF-8")}else o.method==="POST"&&(h["Content-Length"]=0);var Vi=s.agent||!1,X={host:M,port:J,path:le,method:o.method,headers:h,agent:Vi};if(m&&(X.pfx=s.pfx,X.key=s.key,X.passphrase=s.passphrase,X.cert=s.cert,X.ca=s.ca,X.ciphers=s.ciphers,X.rejectUnauthorized=s.rejectUnauthorized!==!1),_=!1,o.async){var Ut=m?r.request:t.request;d=!0,e.dispatchEvent("readystatechange");var qt=function(B){if(n=B,n.statusCode===302||n.statusCode===303||n.statusCode===307){o.url=n.headers.location;var ue=Ps.parse(o.url);M=ue.hostname;var ae={hostname:ue.hostname,port:ue.port,path:ue.path,method:n.statusCode===303?"GET":o.method,headers:h};m&&(ae.pfx=s.pfx,ae.key=s.key,ae.passphrase=s.passphrase,ae.cert=s.cert,ae.ca=s.ca,ae.ciphers=s.ciphers,ae.rejectUnauthorized=s.rejectUnauthorized!==!1),i=Ut(ae,qt).on("error",Wt),i.end();return}w(e.HEADERS_RECEIVED),e.status=n.statusCode,n.on("data",function(ht){if(ht){var Gi=Buffer.from(ht);e.response=Buffer.concat([e.response,Gi])}d&&w(e.LOADING)}),n.on("end",function(){d&&(d=!1,w(e.DONE),e.responseText=e.response.toString("utf8"))}),n.on("error",function(ht){e.handleError(ht)})},Wt=function(B){if(i.reusedSocket&&B.code==="ECONNRESET")return Ut(X,qt).on("error",Wt);e.handleError(B)};i=Ut(X,qt).on("error",Wt),s.autoUnref&&i.on("socket",B=>{B.unref()}),u&&i.write(u),i.end(),e.dispatchEvent("loadstart")}else{var We=".node-xmlhttprequest-content-"+process.pid,Ve=".node-xmlhttprequest-sync-"+process.pid;Se.writeFileSync(Ve,"","utf8");for(var $i="var http = require('http'), https = require('https'), fs = require('fs');var doRequest = http"+(m?"s":"")+".request;var options = "+JSON.stringify(X)+";var responseText = '';var responseData = Buffer.alloc(0);var req = doRequest(options, function(response) {response.on('data', function(chunk) {  var data = Buffer.from(chunk);  responseText += data.toString('utf8');  responseData = Buffer.concat([responseData, data]);});response.on('end', function() {fs.writeFileSync('"+We+"', JSON.stringify({err: null, data: {statusCode: response.statusCode, headers: response.headers, text: responseText, data: responseData.toString('base64')}}), 'utf8');fs.unlinkSync('"+Ve+"');});response.on('error', function(error) {fs.writeFileSync('"+We+"', 'NODE-XMLHTTPREQUEST-ERROR:' + JSON.stringify(error), 'utf8');fs.unlinkSync('"+Ve+"');});}).on('error', function(error) {fs.writeFileSync('"+We+"', 'NODE-XMLHTTPREQUEST-ERROR:' + JSON.stringify(error), 'utf8');fs.unlinkSync('"+Ve+"');});"+(u?"req.write('"+JSON.stringify(u).slice(1,-1).replace(/'/g,"\\'")+"');":"")+"req.end();",Hi=Zi(process.argv[0],["-e",$i]),Ra;Se.existsSync(Ve););if(e.responseText=Se.readFileSync(We,"utf8"),Hi.stdin.end(),Se.unlinkSync(We),e.responseText.match(/^NODE-XMLHTTPREQUEST-ERROR:/)){var ji=JSON.parse(e.responseText.replace(/^NODE-XMLHTTPREQUEST-ERROR:/,""));e.handleError(ji,503)}else{e.status=e.responseText.replace(/^NODE-XMLHTTPREQUEST-STATUS:([0-9]*),.*/,"$1");var Vt=JSON.parse(e.responseText.replace(/^NODE-XMLHTTPREQUEST-STATUS:[0-9]*,(.*)/,"$1"));n={statusCode:e.status,headers:Vt.data.headers},e.responseText=Vt.data.text,e.response=Buffer.from(Vt.data.data,"base64"),w(e.DONE,!0)}}},this.handleError=function(u,m){this.status=m||0,this.statusText=u,this.responseText=u.stack,_=!0,w(this.DONE)},this.abort=function(){i&&(i.abort(),i=null),h=Object.assign({},c),this.responseText="",this.responseXML="",this.response=Buffer.alloc(0),_=y=!0,this.readyState!==this.UNSENT&&(this.readyState!==this.OPENED||d)&&this.readyState!==this.DONE&&(d=!1,w(this.DONE)),this.readyState=this.UNSENT},this.addEventListener=function(u,m){u in p||(p[u]=[]),p[u].push(m)},this.removeEventListener=function(u,m){u in p&&(p[u]=p[u].filter(function(A){return A!==m}))},this.dispatchEvent=function(u){if(typeof e["on"+u]=="function"&&(this.readyState===this.DONE&&o.async?setTimeout(function(){e["on"+u]()},0):e["on"+u]()),u in p)for(let m=0,A=p[u].length;m<A;m++)this.readyState===this.DONE?setTimeout(function(){p[u][m].call(e)},0):p[u][m].call(e)};var w=function(u){if(!(e.readyState===u||e.readyState===e.UNSENT&&y)&&(e.readyState=u,(o.async||e.readyState<e.OPENED||e.readyState===e.DONE)&&e.dispatchEvent("readystatechange"),e.readyState===e.DONE)){let m;y?m="abort":_?m="error":m="load",e.dispatchEvent(m),e.dispatchEvent("loadend")}}}});var de=S(js=>{js.Emitter=P;function P(s){if(s)return en(s)}function en(s){for(var e in P.prototype)s[e]=P.prototype[e];return s}P.prototype.on=P.prototype.addEventListener=function(s,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+s]=this._callbacks["$"+s]||[]).push(e),this};P.prototype.once=function(s,e){function t(){this.off(s,t),e.apply(this,arguments)}return t.fn=e,this.on(s,t),this};P.prototype.off=P.prototype.removeListener=P.prototype.removeAllListeners=P.prototype.removeEventListener=function(s,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+s];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+s],this;for(var r,i=0;i<t.length;i++)if(r=t[i],r===e||r.fn===e){t.splice(i,1);break}return t.length===0&&delete this._callbacks["$"+s],this};P.prototype.emit=function(s){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+s],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(t){t=t.slice(0);for(var r=0,i=t.length;r<i;++r)t[r].apply(this,e)}return this};P.prototype.emitReserved=P.prototype.emit;P.prototype.listeners=function(s){return this._callbacks=this._callbacks||{},this._callbacks["$"+s]||[]};P.prototype.hasListeners=function(s){return!!this.listeners(s).length}});var Qs=S((Ga,Js)=>{var we=1e3,ke=we*60,Ce=ke*60,pe=Ce*24,an=pe*7,cn=pe*365.25;Js.exports=function(s,e){e=e||{};var t=typeof s;if(t==="string"&&s.length>0)return hn(s);if(t==="number"&&isFinite(s))return e.long?ln(s):fn(s);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(s))};function hn(s){if(s=String(s),!(s.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(s);if(e){var t=parseFloat(e[1]),r=(e[2]||"ms").toLowerCase();switch(r){case"years":case"year":case"yrs":case"yr":case"y":return t*cn;case"weeks":case"week":case"w":return t*an;case"days":case"day":case"d":return t*pe;case"hours":case"hour":case"hrs":case"hr":case"h":return t*Ce;case"minutes":case"minute":case"mins":case"min":case"m":return t*ke;case"seconds":case"second":case"secs":case"sec":case"s":return t*we;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function fn(s){var e=Math.abs(s);return e>=pe?Math.round(s/pe)+"d":e>=Ce?Math.round(s/Ce)+"h":e>=ke?Math.round(s/ke)+"m":e>=we?Math.round(s/we)+"s":s+"ms"}function ln(s){var e=Math.abs(s);return e>=pe?mt(s,e,pe,"day"):e>=Ce?mt(s,e,Ce,"hour"):e>=ke?mt(s,e,ke,"minute"):e>=we?mt(s,e,we,"second"):s+" ms"}function mt(s,e,t,r){var i=e>=t*1.5;return Math.round(s/t)+" "+r+(i?"s":"")}});var Yt=S((za,Zs)=>{function un(s){t.debug=t,t.default=t,t.coerce=c,t.disable=o,t.enable=i,t.enabled=a,t.humanize=Qs(),t.destroy=h,Object.keys(s).forEach(f=>{t[f]=s[f]}),t.names=[],t.skips=[],t.formatters={};function e(f){let l=0;for(let d=0;d<f.length;d++)l=(l<<5)-l+f.charCodeAt(d),l|=0;return t.colors[Math.abs(l)%t.colors.length]}t.selectColor=e;function t(f){let l,d=null,_,y;function p(...E){if(!p.enabled)return;let L=p,w=Number(new Date),u=w-(l||w);L.diff=u,L.prev=l,L.curr=w,l=w,E[0]=t.coerce(E[0]),typeof E[0]!="string"&&E.unshift("%O");let m=0;E[0]=E[0].replace(/%([a-zA-Z%])/g,(C,M)=>{if(C==="%%")return"%";m++;let J=t.formatters[M];if(typeof J=="function"){let le=E[m];C=J.call(L,le),E.splice(m,1),m--}return C}),t.formatArgs.call(L,E),(L.log||t.log).apply(L,E)}return p.namespace=f,p.useColors=t.useColors(),p.color=t.selectColor(f),p.extend=r,p.destroy=t.destroy,Object.defineProperty(p,"enabled",{enumerable:!0,configurable:!1,get:()=>d!==null?d:(_!==t.namespaces&&(_=t.namespaces,y=t.enabled(f)),y),set:E=>{d=E}}),typeof t.init=="function"&&t.init(p),p}function r(f,l){let d=t(this.namespace+(typeof l>"u"?":":l)+f);return d.log=this.log,d}function i(f){t.save(f),t.namespaces=f,t.names=[],t.skips=[];let l=(typeof f=="string"?f:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(let d of l)d[0]==="-"?t.skips.push(d.slice(1)):t.names.push(d)}function n(f,l){let d=0,_=0,y=-1,p=0;for(;d<f.length;)if(_<l.length&&(l[_]===f[d]||l[_]==="*"))l[_]==="*"?(y=_,p=d,_++):(d++,_++);else if(y!==-1)_=y+1,p++,d=p;else return!1;for(;_<l.length&&l[_]==="*";)_++;return _===l.length}function o(){let f=[...t.names,...t.skips.map(l=>"-"+l)].join(",");return t.enable(""),f}function a(f){for(let l of t.skips)if(n(f,l))return!1;for(let l of t.names)if(n(f,l))return!0;return!1}function c(f){return f instanceof Error?f.stack||f.message:f}function h(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}Zs.exports=un});var er=S((F,_t)=>{F.formatArgs=pn;F.save=mn;F.load=_n;F.useColors=dn;F.storage=gn();F.destroy=(()=>{let s=!1;return()=>{s||(s=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();F.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function dn(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let s;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(s=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(s[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function pn(s){if(s[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+s[0]+(this.useColors?"%c ":" ")+"+"+_t.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;s.splice(1,0,e,"color: inherit");let t=0,r=0;s[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(t++,i==="%c"&&(r=t))}),s.splice(r,0,e)}F.log=console.debug||console.log||(()=>{});function mn(s){try{s?F.storage.setItem("debug",s):F.storage.removeItem("debug")}catch{}}function _n(){let s;try{s=F.storage.getItem("debug")||F.storage.getItem("DEBUG")}catch{}return!s&&typeof process<"u"&&"env"in process&&(s=process.env.DEBUG),s}function gn(){try{return localStorage}catch{}}_t.exports=Yt()(F);var{formatters:yn}=_t.exports;yn.j=function(s){try{return JSON.stringify(s)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var sr=S((Ya,tr)=>{"use strict";tr.exports=(s,e=process.argv)=>{let t=s.startsWith("-")?"":s.length===1?"-":"--",r=e.indexOf(t+s),i=e.indexOf("--");return r!==-1&&(i===-1||r<i)}});var nr=S((Xa,ir)=>{"use strict";var En=require("os"),rr=require("tty"),W=sr(),{env:T}=process,ce;W("no-color")||W("no-colors")||W("color=false")||W("color=never")?ce=0:(W("color")||W("colors")||W("color=true")||W("color=always"))&&(ce=1);"FORCE_COLOR"in T&&(T.FORCE_COLOR==="true"?ce=1:T.FORCE_COLOR==="false"?ce=0:ce=T.FORCE_COLOR.length===0?1:Math.min(parseInt(T.FORCE_COLOR,10),3));function Xt(s){return s===0?!1:{level:s,hasBasic:!0,has256:s>=2,has16m:s>=3}}function Kt(s,e){if(ce===0)return 0;if(W("color=16m")||W("color=full")||W("color=truecolor"))return 3;if(W("color=256"))return 2;if(s&&!e&&ce===void 0)return 0;let t=ce||0;if(T.TERM==="dumb")return t;if(process.platform==="win32"){let r=En.release().split(".");return Number(r[0])>=10&&Number(r[2])>=10586?Number(r[2])>=14931?3:2:1}if("CI"in T)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some(r=>r in T)||T.CI_NAME==="codeship"?1:t;if("TEAMCITY_VERSION"in T)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(T.TEAMCITY_VERSION)?1:0;if(T.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in T){let r=parseInt((T.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(T.TERM_PROGRAM){case"iTerm.app":return r>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(T.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(T.TERM)||"COLORTERM"in T?1:t}function bn(s){let e=Kt(s,s&&s.isTTY);return Xt(e)}ir.exports={supportsColor:bn,stdout:Xt(Kt(!0,rr.isatty(1))),stderr:Xt(Kt(!0,rr.isatty(2)))}});var ar=S((O,yt)=>{var xn=require("tty"),gt=require("util");O.init=On;O.log=kn;O.formatArgs=Sn;O.save=Cn;O.load=Tn;O.useColors=vn;O.destroy=gt.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");O.colors=[6,2,3,4,5,1];try{let s=nr();s&&(s.stderr||s).level>=2&&(O.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}O.inspectOpts=Object.keys(process.env).filter(s=>/^debug_/i.test(s)).reduce((s,e)=>{let t=e.substring(6).toLowerCase().replace(/_([a-z])/g,(i,n)=>n.toUpperCase()),r=process.env[e];return/^(yes|on|true|enabled)$/i.test(r)?r=!0:/^(no|off|false|disabled)$/i.test(r)?r=!1:r==="null"?r=null:r=Number(r),s[t]=r,s},{});function vn(){return"colors"in O.inspectOpts?!!O.inspectOpts.colors:xn.isatty(process.stderr.fd)}function Sn(s){let{namespace:e,useColors:t}=this;if(t){let r=this.color,i="\x1B[3"+(r<8?r:"8;5;"+r),n=`  ${i};1m${e} \x1B[0m`;s[0]=n+s[0].split(`
`).join(`
`+n),s.push(i+"m+"+yt.exports.humanize(this.diff)+"\x1B[0m")}else s[0]=wn()+e+" "+s[0]}function wn(){return O.inspectOpts.hideDate?"":new Date().toISOString()+" "}function kn(...s){return process.stderr.write(gt.formatWithOptions(O.inspectOpts,...s)+`
`)}function Cn(s){s?process.env.DEBUG=s:delete process.env.DEBUG}function Tn(){return process.env.DEBUG}function On(s){s.inspectOpts={};let e=Object.keys(O.inspectOpts);for(let t=0;t<e.length;t++)s.inspectOpts[e[t]]=O.inspectOpts[e[t]]}yt.exports=Yt()(O);var{formatters:or}=yt.exports;or.o=function(s){return this.inspectOpts.colors=this.useColors,gt.inspect(s,this.inspectOpts).split(`
`).map(e=>e.trim()).join(" ")};or.O=function(s){return this.inspectOpts.colors=this.useColors,gt.inspect(s,this.inspectOpts)}});var V=S((Ka,Jt)=>{typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?Jt.exports=er():Jt.exports=ar()});var se=S((pc,yr)=>{"use strict";var _r=["nodebuffer","arraybuffer","fragments"],gr=typeof Blob<"u";gr&&_r.push("blob");yr.exports={BINARY_TYPES:_r,EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",hasBlob:gr,kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}});var Ye=S((mc,xt)=>{"use strict";var{EMPTY_BUFFER:Bn}=se(),es=Buffer[Symbol.species];function Pn(s,e){if(s.length===0)return Bn;if(s.length===1)return s[0];let t=Buffer.allocUnsafe(e),r=0;for(let i=0;i<s.length;i++){let n=s[i];t.set(n,r),r+=n.length}return r<e?new es(t.buffer,t.byteOffset,r):t}function Er(s,e,t,r,i){for(let n=0;n<i;n++)t[r+n]=s[n]^e[n&3]}function br(s,e){for(let t=0;t<s.length;t++)s[t]^=e[t&3]}function Dn(s){return s.length===s.buffer.byteLength?s.buffer:s.buffer.slice(s.byteOffset,s.byteOffset+s.length)}function ts(s){if(ts.readOnly=!0,Buffer.isBuffer(s))return s;let e;return s instanceof ArrayBuffer?e=new es(s):ArrayBuffer.isView(s)?e=new es(s.buffer,s.byteOffset,s.byteLength):(e=Buffer.from(s),ts.readOnly=!1),e}xt.exports={concat:Pn,mask:Er,toArrayBuffer:Dn,toBuffer:ts,unmask:br};if(!process.env.WS_NO_BUFFER_UTIL)try{let s=require("bufferutil");xt.exports.mask=function(e,t,r,i,n){n<48?Er(e,t,r,i,n):s.mask(e,t,r,i,n)},xt.exports.unmask=function(e,t){e.length<32?br(e,t):s.unmask(e,t)}}catch{}});var Sr=S((_c,vr)=>{"use strict";var xr=Symbol("kDone"),ss=Symbol("kRun"),rs=class{constructor(e){this[xr]=()=>{this.pending--,this[ss]()},this.concurrency=e||1/0,this.jobs=[],this.pending=0}add(e){this.jobs.push(e),this[ss]()}[ss](){if(this.pending!==this.concurrency&&this.jobs.length){let e=this.jobs.shift();this.pending++,e(this[xr])}}};vr.exports=rs});var Ke=S((gc,Tr)=>{"use strict";var Xe=require("zlib"),wr=Ye(),Fn=Sr(),{kStatusCode:kr}=se(),In=Buffer[Symbol.species],Mn=Buffer.from([0,0,255,255]),St=Symbol("permessage-deflate"),re=Symbol("total-length"),Oe=Symbol("callback"),he=Symbol("buffers"),Re=Symbol("error"),vt,is=class{constructor(e,t,r){if(this._maxPayload=r|0,this._options=e||{},this._threshold=this._options.threshold!==void 0?this._options.threshold:1024,this._isServer=!!t,this._deflate=null,this._inflate=null,this.params=null,!vt){let i=this._options.concurrencyLimit!==void 0?this._options.concurrencyLimit:10;vt=new Fn(i)}}static get extensionName(){return"permessage-deflate"}offer(){let e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:this._options.clientMaxWindowBits==null&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){let e=this._deflate[Oe];this._deflate.close(),this._deflate=null,e&&e(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(e){let t=this._options,r=e.find(i=>!(t.serverNoContextTakeover===!1&&i.server_no_context_takeover||i.server_max_window_bits&&(t.serverMaxWindowBits===!1||typeof t.serverMaxWindowBits=="number"&&t.serverMaxWindowBits>i.server_max_window_bits)||typeof t.clientMaxWindowBits=="number"&&!i.client_max_window_bits));if(!r)throw new Error("None of the extension offers can be accepted");return t.serverNoContextTakeover&&(r.server_no_context_takeover=!0),t.clientNoContextTakeover&&(r.client_no_context_takeover=!0),typeof t.serverMaxWindowBits=="number"&&(r.server_max_window_bits=t.serverMaxWindowBits),typeof t.clientMaxWindowBits=="number"?r.client_max_window_bits=t.clientMaxWindowBits:(r.client_max_window_bits===!0||t.clientMaxWindowBits===!1)&&delete r.client_max_window_bits,r}acceptAsClient(e){let t=e[0];if(this._options.clientNoContextTakeover===!1&&t.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(!t.client_max_window_bits)typeof this._options.clientMaxWindowBits=="number"&&(t.client_max_window_bits=this._options.clientMaxWindowBits);else if(this._options.clientMaxWindowBits===!1||typeof this._options.clientMaxWindowBits=="number"&&t.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"');return t}normalizeParams(e){return e.forEach(t=>{Object.keys(t).forEach(r=>{let i=t[r];if(i.length>1)throw new Error(`Parameter "${r}" must have only a single value`);if(i=i[0],r==="client_max_window_bits"){if(i!==!0){let n=+i;if(!Number.isInteger(n)||n<8||n>15)throw new TypeError(`Invalid value for parameter "${r}": ${i}`);i=n}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${r}": ${i}`)}else if(r==="server_max_window_bits"){let n=+i;if(!Number.isInteger(n)||n<8||n>15)throw new TypeError(`Invalid value for parameter "${r}": ${i}`);i=n}else if(r==="client_no_context_takeover"||r==="server_no_context_takeover"){if(i!==!0)throw new TypeError(`Invalid value for parameter "${r}": ${i}`)}else throw new Error(`Unknown parameter "${r}"`);t[r]=i})}),e}decompress(e,t,r){vt.add(i=>{this._decompress(e,t,(n,o)=>{i(),r(n,o)})})}compress(e,t,r){vt.add(i=>{this._compress(e,t,(n,o)=>{i(),r(n,o)})})}_decompress(e,t,r){let i=this._isServer?"client":"server";if(!this._inflate){let n=`${i}_max_window_bits`,o=typeof this.params[n]!="number"?Xe.Z_DEFAULT_WINDOWBITS:this.params[n];this._inflate=Xe.createInflateRaw({...this._options.zlibInflateOptions,windowBits:o}),this._inflate[St]=this,this._inflate[re]=0,this._inflate[he]=[],this._inflate.on("error",qn),this._inflate.on("data",Cr)}this._inflate[Oe]=r,this._inflate.write(e),t&&this._inflate.write(Mn),this._inflate.flush(()=>{let n=this._inflate[Re];if(n){this._inflate.close(),this._inflate=null,r(n);return}let o=wr.concat(this._inflate[he],this._inflate[re]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[re]=0,this._inflate[he]=[],t&&this.params[`${i}_no_context_takeover`]&&this._inflate.reset()),r(null,o)})}_compress(e,t,r){let i=this._isServer?"server":"client";if(!this._deflate){let n=`${i}_max_window_bits`,o=typeof this.params[n]!="number"?Xe.Z_DEFAULT_WINDOWBITS:this.params[n];this._deflate=Xe.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:o}),this._deflate[re]=0,this._deflate[he]=[],this._deflate.on("data",Un)}this._deflate[Oe]=r,this._deflate.write(e),this._deflate.flush(Xe.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let n=wr.concat(this._deflate[he],this._deflate[re]);t&&(n=new In(n.buffer,n.byteOffset,n.length-4)),this._deflate[Oe]=null,this._deflate[re]=0,this._deflate[he]=[],t&&this.params[`${i}_no_context_takeover`]&&this._deflate.reset(),r(null,n)})}};Tr.exports=is;function Un(s){this[he].push(s),this[re]+=s.length}function Cr(s){if(this[re]+=s.length,this[St]._maxPayload<1||this[re]<=this[St]._maxPayload){this[he].push(s);return}this[Re]=new RangeError("Max payload size exceeded"),this[Re].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[Re][kr]=1009,this.removeListener("data",Cr),this.reset()}function qn(s){if(this[St]._inflate=null,this[Re]){this[Oe](this[Re]);return}s[kr]=1007,this[Oe](s)}});var Ne=S((yc,wt)=>{"use strict";var{isUtf8:Or}=require("buffer"),{hasBlob:Wn}=se(),Vn=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function $n(s){return s>=1e3&&s<=1014&&s!==1004&&s!==1005&&s!==1006||s>=3e3&&s<=4999}function ns(s){let e=s.length,t=0;for(;t<e;)if((s[t]&128)===0)t++;else if((s[t]&224)===192){if(t+1===e||(s[t+1]&192)!==128||(s[t]&254)===192)return!1;t+=2}else if((s[t]&240)===224){if(t+2>=e||(s[t+1]&192)!==128||(s[t+2]&192)!==128||s[t]===224&&(s[t+1]&224)===128||s[t]===237&&(s[t+1]&224)===160)return!1;t+=3}else if((s[t]&248)===240){if(t+3>=e||(s[t+1]&192)!==128||(s[t+2]&192)!==128||(s[t+3]&192)!==128||s[t]===240&&(s[t+1]&240)===128||s[t]===244&&s[t+1]>143||s[t]>244)return!1;t+=4}else return!1;return!0}function Hn(s){return Wn&&typeof s=="object"&&typeof s.arrayBuffer=="function"&&typeof s.type=="string"&&typeof s.stream=="function"&&(s[Symbol.toStringTag]==="Blob"||s[Symbol.toStringTag]==="File")}wt.exports={isBlob:Hn,isValidStatusCode:$n,isValidUTF8:ns,tokenChars:Vn};if(Or)wt.exports.isValidUTF8=function(s){return s.length<24?ns(s):Or(s)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{let s=require("utf-8-validate");wt.exports.isValidUTF8=function(e){return e.length<32?ns(e):s(e)}}catch{}});var fs=S((Ec,Dr)=>{"use strict";var{Writable:jn}=require("stream"),Rr=Ke(),{BINARY_TYPES:Gn,EMPTY_BUFFER:Nr,kStatusCode:zn,kWebSocket:Yn}=se(),{concat:os,toArrayBuffer:Xn,unmask:Kn}=Ye(),{isValidStatusCode:Jn,isValidUTF8:Lr}=Ne(),kt=Buffer[Symbol.species],$=0,Ar=1,Br=2,Pr=3,as=4,cs=5,Ct=6,hs=class extends jn{constructor(e={}){super(),this._allowSynchronousEvents=e.allowSynchronousEvents!==void 0?e.allowSynchronousEvents:!0,this._binaryType=e.binaryType||Gn[0],this._extensions=e.extensions||{},this._isServer=!!e.isServer,this._maxPayload=e.maxPayload|0,this._skipUTF8Validation=!!e.skipUTF8Validation,this[Yn]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._errored=!1,this._loop=!1,this._state=$}_write(e,t,r){if(this._opcode===8&&this._state==$)return r();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(r)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){let r=this._buffers[0];return this._buffers[0]=new kt(r.buffer,r.byteOffset+e,r.length-e),new kt(r.buffer,r.byteOffset,e)}let t=Buffer.allocUnsafe(e);do{let r=this._buffers[0],i=t.length-e;e>=r.length?t.set(this._buffers.shift(),i):(t.set(new Uint8Array(r.buffer,r.byteOffset,e),i),this._buffers[0]=new kt(r.buffer,r.byteOffset+e,r.length-e)),e-=r.length}while(e>0);return t}startLoop(e){this._loop=!0;do switch(this._state){case $:this.getInfo(e);break;case Ar:this.getPayloadLength16(e);break;case Br:this.getPayloadLength64(e);break;case Pr:this.getMask();break;case as:this.getData(e);break;case cs:case Ct:this._loop=!1;return}while(this._loop);this._errored||e()}getInfo(e){if(this._bufferedBytes<2){this._loop=!1;return}let t=this.consume(2);if((t[0]&48)!==0){let i=this.createError(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3");e(i);return}let r=(t[0]&64)===64;if(r&&!this._extensions[Rr.extensionName]){let i=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");e(i);return}if(this._fin=(t[0]&128)===128,this._opcode=t[0]&15,this._payloadLength=t[1]&127,this._opcode===0){if(r){let i=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");e(i);return}if(!this._fragmented){let i=this.createError(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE");e(i);return}this._opcode=this._fragmented}else if(this._opcode===1||this._opcode===2){if(this._fragmented){let i=this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");e(i);return}this._compressed=r}else if(this._opcode>7&&this._opcode<11){if(!this._fin){let i=this.createError(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN");e(i);return}if(r){let i=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");e(i);return}if(this._payloadLength>125||this._opcode===8&&this._payloadLength===1){let i=this.createError(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH");e(i);return}}else{let i=this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");e(i);return}if(!this._fin&&!this._fragmented&&(this._fragmented=this._opcode),this._masked=(t[1]&128)===128,this._isServer){if(!this._masked){let i=this.createError(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK");e(i);return}}else if(this._masked){let i=this.createError(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK");e(i);return}this._payloadLength===126?this._state=Ar:this._payloadLength===127?this._state=Br:this.haveLength(e)}getPayloadLength16(e){if(this._bufferedBytes<2){this._loop=!1;return}this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength(e)}getPayloadLength64(e){if(this._bufferedBytes<8){this._loop=!1;return}let t=this.consume(8),r=t.readUInt32BE(0);if(r>Math.pow(2,21)-1){let i=this.createError(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH");e(i);return}this._payloadLength=r*Math.pow(2,32)+t.readUInt32BE(4),this.haveLength(e)}haveLength(e){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0)){let t=this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");e(t);return}this._masked?this._state=Pr:this._state=as}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=as}getData(e){let t=Nr;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}t=this.consume(this._payloadLength),this._masked&&(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])!==0&&Kn(t,this._mask)}if(this._opcode>7){this.controlMessage(t,e);return}if(this._compressed){this._state=cs,this.decompress(t,e);return}t.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(t)),this.dataMessage(e)}decompress(e,t){this._extensions[Rr.extensionName].decompress(e,this._fin,(i,n)=>{if(i)return t(i);if(n.length){if(this._messageLength+=n.length,this._messageLength>this._maxPayload&&this._maxPayload>0){let o=this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");t(o);return}this._fragments.push(n)}this.dataMessage(t),this._state===$&&this.startLoop(t)})}dataMessage(e){if(!this._fin){this._state=$;return}let t=this._messageLength,r=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],this._opcode===2){let i;this._binaryType==="nodebuffer"?i=os(r,t):this._binaryType==="arraybuffer"?i=Xn(os(r,t)):this._binaryType==="blob"?i=new Blob(r):i=r,this._allowSynchronousEvents?(this.emit("message",i,!0),this._state=$):(this._state=Ct,setImmediate(()=>{this.emit("message",i,!0),this._state=$,this.startLoop(e)}))}else{let i=os(r,t);if(!this._skipUTF8Validation&&!Lr(i)){let n=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");e(n);return}this._state===cs||this._allowSynchronousEvents?(this.emit("message",i,!1),this._state=$):(this._state=Ct,setImmediate(()=>{this.emit("message",i,!1),this._state=$,this.startLoop(e)}))}}controlMessage(e,t){if(this._opcode===8){if(e.length===0)this._loop=!1,this.emit("conclude",1005,Nr),this.end();else{let r=e.readUInt16BE(0);if(!Jn(r)){let n=this.createError(RangeError,`invalid status code ${r}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");t(n);return}let i=new kt(e.buffer,e.byteOffset+2,e.length-2);if(!this._skipUTF8Validation&&!Lr(i)){let n=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");t(n);return}this._loop=!1,this.emit("conclude",r,i),this.end()}this._state=$;return}this._allowSynchronousEvents?(this.emit(this._opcode===9?"ping":"pong",e),this._state=$):(this._state=Ct,setImmediate(()=>{this.emit(this._opcode===9?"ping":"pong",e),this._state=$,this.startLoop(t)}))}createError(e,t,r,i,n){this._loop=!1,this._errored=!0;let o=new e(r?`Invalid WebSocket frame: ${t}`:t);return Error.captureStackTrace(o,this.createError),o.code=n,o[zn]=i,o}};Dr.exports=hs});var ds=S((xc,Mr)=>{"use strict";var{Duplex:bc}=require("stream"),{randomFillSync:Qn}=require("crypto"),Fr=Ke(),{EMPTY_BUFFER:Zn,kWebSocket:eo,NOOP:to}=se(),{isBlob:Le,isValidStatusCode:so}=Ne(),{mask:Ir,toBuffer:me}=Ye(),H=Symbol("kByteLength"),ro=Buffer.alloc(4),Tt=8*1024,_e,Ae=Tt,z=0,io=1,no=2,ls=class s{constructor(e,t,r){this._extensions=t||{},r&&(this._generateMask=r,this._maskBuffer=Buffer.alloc(4)),this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._queue=[],this._state=z,this.onerror=to,this[eo]=void 0}static frame(e,t){let r,i=!1,n=2,o=!1;t.mask&&(r=t.maskBuffer||ro,t.generateMask?t.generateMask(r):(Ae===Tt&&(_e===void 0&&(_e=Buffer.alloc(Tt)),Qn(_e,0,Tt),Ae=0),r[0]=_e[Ae++],r[1]=_e[Ae++],r[2]=_e[Ae++],r[3]=_e[Ae++]),o=(r[0]|r[1]|r[2]|r[3])===0,n=6);let a;typeof e=="string"?(!t.mask||o)&&t[H]!==void 0?a=t[H]:(e=Buffer.from(e),a=e.length):(a=e.length,i=t.mask&&t.readOnly&&!o);let c=a;a>=65536?(n+=8,c=127):a>125&&(n+=2,c=126);let h=Buffer.allocUnsafe(i?a+n:n);return h[0]=t.fin?t.opcode|128:t.opcode,t.rsv1&&(h[0]|=64),h[1]=c,c===126?h.writeUInt16BE(a,2):c===127&&(h[2]=h[3]=0,h.writeUIntBE(a,4,6)),t.mask?(h[1]|=128,h[n-4]=r[0],h[n-3]=r[1],h[n-2]=r[2],h[n-1]=r[3],o?[h,e]:i?(Ir(e,r,h,n,a),[h]):(Ir(e,r,e,0,a),[h,e])):[h,e]}close(e,t,r,i){let n;if(e===void 0)n=Zn;else{if(typeof e!="number"||!so(e))throw new TypeError("First argument must be a valid error code number");if(t===void 0||!t.length)n=Buffer.allocUnsafe(2),n.writeUInt16BE(e,0);else{let a=Buffer.byteLength(t);if(a>123)throw new RangeError("The message must not be greater than 123 bytes");n=Buffer.allocUnsafe(2+a),n.writeUInt16BE(e,0),typeof t=="string"?n.write(t,2):n.set(t,2)}}let o={[H]:n.length,fin:!0,generateMask:this._generateMask,mask:r,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};this._state!==z?this.enqueue([this.dispatch,n,!1,o,i]):this.sendFrame(s.frame(n,o),i)}ping(e,t,r){let i,n;if(typeof e=="string"?(i=Buffer.byteLength(e),n=!1):Le(e)?(i=e.size,n=!1):(e=me(e),i=e.length,n=me.readOnly),i>125)throw new RangeError("The data size must not be greater than 125 bytes");let o={[H]:i,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:9,readOnly:n,rsv1:!1};Le(e)?this._state!==z?this.enqueue([this.getBlobData,e,!1,o,r]):this.getBlobData(e,!1,o,r):this._state!==z?this.enqueue([this.dispatch,e,!1,o,r]):this.sendFrame(s.frame(e,o),r)}pong(e,t,r){let i,n;if(typeof e=="string"?(i=Buffer.byteLength(e),n=!1):Le(e)?(i=e.size,n=!1):(e=me(e),i=e.length,n=me.readOnly),i>125)throw new RangeError("The data size must not be greater than 125 bytes");let o={[H]:i,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:10,readOnly:n,rsv1:!1};Le(e)?this._state!==z?this.enqueue([this.getBlobData,e,!1,o,r]):this.getBlobData(e,!1,o,r):this._state!==z?this.enqueue([this.dispatch,e,!1,o,r]):this.sendFrame(s.frame(e,o),r)}send(e,t,r){let i=this._extensions[Fr.extensionName],n=t.binary?2:1,o=t.compress,a,c;typeof e=="string"?(a=Buffer.byteLength(e),c=!1):Le(e)?(a=e.size,c=!1):(e=me(e),a=e.length,c=me.readOnly),this._firstFragment?(this._firstFragment=!1,o&&i&&i.params[i._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(o=a>=i._threshold),this._compress=o):(o=!1,n=0),t.fin&&(this._firstFragment=!0);let h={[H]:a,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:n,readOnly:c,rsv1:o};Le(e)?this._state!==z?this.enqueue([this.getBlobData,e,this._compress,h,r]):this.getBlobData(e,this._compress,h,r):this._state!==z?this.enqueue([this.dispatch,e,this._compress,h,r]):this.dispatch(e,this._compress,h,r)}getBlobData(e,t,r,i){this._bufferedBytes+=r[H],this._state=no,e.arrayBuffer().then(n=>{if(this._socket.destroyed){let a=new Error("The socket was closed while the blob was being read");process.nextTick(us,this,a,i);return}this._bufferedBytes-=r[H];let o=me(n);t?this.dispatch(o,t,r,i):(this._state=z,this.sendFrame(s.frame(o,r),i),this.dequeue())}).catch(n=>{process.nextTick(oo,this,n,i)})}dispatch(e,t,r,i){if(!t){this.sendFrame(s.frame(e,r),i);return}let n=this._extensions[Fr.extensionName];this._bufferedBytes+=r[H],this._state=io,n.compress(e,r.fin,(o,a)=>{if(this._socket.destroyed){let c=new Error("The socket was closed while data was being compressed");us(this,c,i);return}this._bufferedBytes-=r[H],this._state=z,r.readOnly=!1,this.sendFrame(s.frame(a,r),i),this.dequeue()})}dequeue(){for(;this._state===z&&this._queue.length;){let e=this._queue.shift();this._bufferedBytes-=e[3][H],Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[3][H],this._queue.push(e)}sendFrame(e,t){e.length===2?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],t),this._socket.uncork()):this._socket.write(e[0],t)}};Mr.exports=ls;function us(s,e,t){typeof t=="function"&&t(e);for(let r=0;r<s._queue.length;r++){let i=s._queue[r],n=i[i.length-1];typeof n=="function"&&n(e)}}function oo(s,e,t){us(s,e,t),s.onerror(e)}});var zr=S((vc,Gr)=>{"use strict";var{kForOnEventAttribute:Je,kListener:ps}=se(),Ur=Symbol("kCode"),qr=Symbol("kData"),Wr=Symbol("kError"),Vr=Symbol("kMessage"),$r=Symbol("kReason"),Be=Symbol("kTarget"),Hr=Symbol("kType"),jr=Symbol("kWasClean"),ie=class{constructor(e){this[Be]=null,this[Hr]=e}get target(){return this[Be]}get type(){return this[Hr]}};Object.defineProperty(ie.prototype,"target",{enumerable:!0});Object.defineProperty(ie.prototype,"type",{enumerable:!0});var ge=class extends ie{constructor(e,t={}){super(e),this[Ur]=t.code===void 0?0:t.code,this[$r]=t.reason===void 0?"":t.reason,this[jr]=t.wasClean===void 0?!1:t.wasClean}get code(){return this[Ur]}get reason(){return this[$r]}get wasClean(){return this[jr]}};Object.defineProperty(ge.prototype,"code",{enumerable:!0});Object.defineProperty(ge.prototype,"reason",{enumerable:!0});Object.defineProperty(ge.prototype,"wasClean",{enumerable:!0});var Pe=class extends ie{constructor(e,t={}){super(e),this[Wr]=t.error===void 0?null:t.error,this[Vr]=t.message===void 0?"":t.message}get error(){return this[Wr]}get message(){return this[Vr]}};Object.defineProperty(Pe.prototype,"error",{enumerable:!0});Object.defineProperty(Pe.prototype,"message",{enumerable:!0});var Qe=class extends ie{constructor(e,t={}){super(e),this[qr]=t.data===void 0?null:t.data}get data(){return this[qr]}};Object.defineProperty(Qe.prototype,"data",{enumerable:!0});var ao={addEventListener(s,e,t={}){for(let i of this.listeners(s))if(!t[Je]&&i[ps]===e&&!i[Je])return;let r;if(s==="message")r=function(n,o){let a=new Qe("message",{data:o?n:n.toString()});a[Be]=this,Ot(e,this,a)};else if(s==="close")r=function(n,o){let a=new ge("close",{code:n,reason:o.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});a[Be]=this,Ot(e,this,a)};else if(s==="error")r=function(n){let o=new Pe("error",{error:n,message:n.message});o[Be]=this,Ot(e,this,o)};else if(s==="open")r=function(){let n=new ie("open");n[Be]=this,Ot(e,this,n)};else return;r[Je]=!!t[Je],r[ps]=e,t.once?this.once(s,r):this.on(s,r)},removeEventListener(s,e){for(let t of this.listeners(s))if(t[ps]===e&&!t[Je]){this.removeListener(s,t);break}}};Gr.exports={CloseEvent:ge,ErrorEvent:Pe,Event:ie,EventTarget:ao,MessageEvent:Qe};function Ot(s,e,t){typeof s=="object"&&s.handleEvent?s.handleEvent.call(s,t):s.call(e,t)}});var ms=S((Sc,Yr)=>{"use strict";var{tokenChars:Ze}=Ne();function K(s,e,t){s[e]===void 0?s[e]=[t]:s[e].push(t)}function co(s){let e=Object.create(null),t=Object.create(null),r=!1,i=!1,n=!1,o,a,c=-1,h=-1,f=-1,l=0;for(;l<s.length;l++)if(h=s.charCodeAt(l),o===void 0)if(f===-1&&Ze[h]===1)c===-1&&(c=l);else if(l!==0&&(h===32||h===9))f===-1&&c!==-1&&(f=l);else if(h===59||h===44){if(c===-1)throw new SyntaxError(`Unexpected character at index ${l}`);f===-1&&(f=l);let _=s.slice(c,f);h===44?(K(e,_,t),t=Object.create(null)):o=_,c=f=-1}else throw new SyntaxError(`Unexpected character at index ${l}`);else if(a===void 0)if(f===-1&&Ze[h]===1)c===-1&&(c=l);else if(h===32||h===9)f===-1&&c!==-1&&(f=l);else if(h===59||h===44){if(c===-1)throw new SyntaxError(`Unexpected character at index ${l}`);f===-1&&(f=l),K(t,s.slice(c,f),!0),h===44&&(K(e,o,t),t=Object.create(null),o=void 0),c=f=-1}else if(h===61&&c!==-1&&f===-1)a=s.slice(c,l),c=f=-1;else throw new SyntaxError(`Unexpected character at index ${l}`);else if(i){if(Ze[h]!==1)throw new SyntaxError(`Unexpected character at index ${l}`);c===-1?c=l:r||(r=!0),i=!1}else if(n)if(Ze[h]===1)c===-1&&(c=l);else if(h===34&&c!==-1)n=!1,f=l;else if(h===92)i=!0;else throw new SyntaxError(`Unexpected character at index ${l}`);else if(h===34&&s.charCodeAt(l-1)===61)n=!0;else if(f===-1&&Ze[h]===1)c===-1&&(c=l);else if(c!==-1&&(h===32||h===9))f===-1&&(f=l);else if(h===59||h===44){if(c===-1)throw new SyntaxError(`Unexpected character at index ${l}`);f===-1&&(f=l);let _=s.slice(c,f);r&&(_=_.replace(/\\/g,""),r=!1),K(t,a,_),h===44&&(K(e,o,t),t=Object.create(null),o=void 0),a=void 0,c=f=-1}else throw new SyntaxError(`Unexpected character at index ${l}`);if(c===-1||n||h===32||h===9)throw new SyntaxError("Unexpected end of input");f===-1&&(f=l);let d=s.slice(c,f);return o===void 0?K(e,d,t):(a===void 0?K(t,d,!0):r?K(t,a,d.replace(/\\/g,"")):K(t,a,d),K(e,o,t)),e}function ho(s){return Object.keys(s).map(e=>{let t=s[e];return Array.isArray(t)||(t=[t]),t.map(r=>[e].concat(Object.keys(r).map(i=>{let n=r[i];return Array.isArray(n)||(n=[n]),n.map(o=>o===!0?i:`${i}=${o}`).join("; ")})).join("; ")).join(", ")}).join(", ")}Yr.exports={format:ho,parse:co}});var At=S((Cc,oi)=>{"use strict";var fo=require("events"),lo=require("https"),uo=require("http"),Jr=require("net"),po=require("tls"),{randomBytes:mo,createHash:_o}=require("crypto"),{Duplex:wc,Readable:kc}=require("stream"),{URL:_s}=require("url"),fe=Ke(),go=fs(),yo=ds(),{isBlob:Eo}=Ne(),{BINARY_TYPES:Xr,EMPTY_BUFFER:Rt,GUID:bo,kForOnEventAttribute:gs,kListener:xo,kStatusCode:vo,kWebSocket:R,NOOP:Qr}=se(),{EventTarget:{addEventListener:So,removeEventListener:wo}}=zr(),{format:ko,parse:Co}=ms(),{toBuffer:To}=Ye(),Oo=30*1e3,Zr=Symbol("kAborted"),ys=[8,13],ne=["CONNECTING","OPEN","CLOSING","CLOSED"],Ro=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/,v=class s extends fo{constructor(e,t,r){super(),this._binaryType=Xr[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=Rt,this._closeTimer=null,this._errorEmitted=!1,this._extensions={},this._paused=!1,this._protocol="",this._readyState=s.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,e!==null?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,t===void 0?t=[]:Array.isArray(t)||(typeof t=="object"&&t!==null?(r=t,t=[]):t=[t]),ei(this,e,t,r)):(this._autoPong=r.autoPong,this._isServer=!0)}get binaryType(){return this._binaryType}set binaryType(e){Xr.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(e,t,r){let i=new go({allowSynchronousEvents:r.allowSynchronousEvents,binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:r.maxPayload,skipUTF8Validation:r.skipUTF8Validation}),n=new yo(e,this._extensions,r.generateMask);this._receiver=i,this._sender=n,this._socket=e,i[R]=this,n[R]=this,e[R]=this,i.on("conclude",Ao),i.on("drain",Bo),i.on("error",Po),i.on("message",Do),i.on("ping",Fo),i.on("pong",Io),n.onerror=Mo,e.setTimeout&&e.setTimeout(0),e.setNoDelay&&e.setNoDelay(),t.length>0&&e.unshift(t),e.on("close",ri),e.on("data",Lt),e.on("end",ii),e.on("error",ni),this._readyState=s.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=s.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[fe.extensionName]&&this._extensions[fe.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=s.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(e,t){if(this.readyState!==s.CLOSED){if(this.readyState===s.CONNECTING){U(this,this._req,"WebSocket was closed before the connection was established");return}if(this.readyState===s.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=s.CLOSING,this._sender.close(e,t,!this._isServer,r=>{r||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),si(this)}}pause(){this.readyState===s.CONNECTING||this.readyState===s.CLOSED||(this._paused=!0,this._socket.pause())}ping(e,t,r){if(this.readyState===s.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof e=="function"?(r=e,e=t=void 0):typeof t=="function"&&(r=t,t=void 0),typeof e=="number"&&(e=e.toString()),this.readyState!==s.OPEN){Es(this,e,r);return}t===void 0&&(t=!this._isServer),this._sender.ping(e||Rt,t,r)}pong(e,t,r){if(this.readyState===s.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof e=="function"?(r=e,e=t=void 0):typeof t=="function"&&(r=t,t=void 0),typeof e=="number"&&(e=e.toString()),this.readyState!==s.OPEN){Es(this,e,r);return}t===void 0&&(t=!this._isServer),this._sender.pong(e||Rt,t,r)}resume(){this.readyState===s.CONNECTING||this.readyState===s.CLOSED||(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(e,t,r){if(this.readyState===s.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof t=="function"&&(r=t,t={}),typeof e=="number"&&(e=e.toString()),this.readyState!==s.OPEN){Es(this,e,r);return}let i={binary:typeof e!="string",mask:!this._isServer,compress:!0,fin:!0,...t};this._extensions[fe.extensionName]||(i.compress=!1),this._sender.send(e||Rt,i,r)}terminate(){if(this.readyState!==s.CLOSED){if(this.readyState===s.CONNECTING){U(this,this._req,"WebSocket was closed before the connection was established");return}this._socket&&(this._readyState=s.CLOSING,this._socket.destroy())}}};Object.defineProperty(v,"CONNECTING",{enumerable:!0,value:ne.indexOf("CONNECTING")});Object.defineProperty(v.prototype,"CONNECTING",{enumerable:!0,value:ne.indexOf("CONNECTING")});Object.defineProperty(v,"OPEN",{enumerable:!0,value:ne.indexOf("OPEN")});Object.defineProperty(v.prototype,"OPEN",{enumerable:!0,value:ne.indexOf("OPEN")});Object.defineProperty(v,"CLOSING",{enumerable:!0,value:ne.indexOf("CLOSING")});Object.defineProperty(v.prototype,"CLOSING",{enumerable:!0,value:ne.indexOf("CLOSING")});Object.defineProperty(v,"CLOSED",{enumerable:!0,value:ne.indexOf("CLOSED")});Object.defineProperty(v.prototype,"CLOSED",{enumerable:!0,value:ne.indexOf("CLOSED")});["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(s=>{Object.defineProperty(v.prototype,s,{enumerable:!0})});["open","error","close","message"].forEach(s=>{Object.defineProperty(v.prototype,`on${s}`,{enumerable:!0,get(){for(let e of this.listeners(s))if(e[gs])return e[xo];return null},set(e){for(let t of this.listeners(s))if(t[gs]){this.removeListener(s,t);break}typeof e=="function"&&this.addEventListener(s,e,{[gs]:!0})}})});v.prototype.addEventListener=So;v.prototype.removeEventListener=wo;oi.exports=v;function ei(s,e,t,r){let i={allowSynchronousEvents:!0,autoPong:!0,protocolVersion:ys[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...r,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(s._autoPong=i.autoPong,!ys.includes(i.protocolVersion))throw new RangeError(`Unsupported protocol version: ${i.protocolVersion} (supported versions: ${ys.join(", ")})`);let n;if(e instanceof _s)n=e;else try{n=new _s(e)}catch{throw new SyntaxError(`Invalid URL: ${e}`)}n.protocol==="http:"?n.protocol="ws:":n.protocol==="https:"&&(n.protocol="wss:"),s._url=n.href;let o=n.protocol==="wss:",a=n.protocol==="ws+unix:",c;if(n.protocol!=="ws:"&&!o&&!a?c=`The URL's protocol must be one of "ws:", "wss:", "http:", "https:", or "ws+unix:"`:a&&!n.pathname?c="The URL's pathname is empty":n.hash&&(c="The URL contains a fragment identifier"),c){let p=new SyntaxError(c);if(s._redirects===0)throw p;Nt(s,p);return}let h=o?443:80,f=mo(16).toString("base64"),l=o?lo.request:uo.request,d=new Set,_;if(i.createConnection=i.createConnection||(o?Lo:No),i.defaultPort=i.defaultPort||h,i.port=n.port||h,i.host=n.hostname.startsWith("[")?n.hostname.slice(1,-1):n.hostname,i.headers={...i.headers,"Sec-WebSocket-Version":i.protocolVersion,"Sec-WebSocket-Key":f,Connection:"Upgrade",Upgrade:"websocket"},i.path=n.pathname+n.search,i.timeout=i.handshakeTimeout,i.perMessageDeflate&&(_=new fe(i.perMessageDeflate!==!0?i.perMessageDeflate:{},!1,i.maxPayload),i.headers["Sec-WebSocket-Extensions"]=ko({[fe.extensionName]:_.offer()})),t.length){for(let p of t){if(typeof p!="string"||!Ro.test(p)||d.has(p))throw new SyntaxError("An invalid or duplicated subprotocol was specified");d.add(p)}i.headers["Sec-WebSocket-Protocol"]=t.join(",")}if(i.origin&&(i.protocolVersion<13?i.headers["Sec-WebSocket-Origin"]=i.origin:i.headers.Origin=i.origin),(n.username||n.password)&&(i.auth=`${n.username}:${n.password}`),a){let p=i.path.split(":");i.socketPath=p[0],i.path=p[1]}let y;if(i.followRedirects){if(s._redirects===0){s._originalIpc=a,s._originalSecure=o,s._originalHostOrSocketPath=a?i.socketPath:n.host;let p=r&&r.headers;if(r={...r,headers:{}},p)for(let[E,L]of Object.entries(p))r.headers[E.toLowerCase()]=L}else if(s.listenerCount("redirect")===0){let p=a?s._originalIpc?i.socketPath===s._originalHostOrSocketPath:!1:s._originalIpc?!1:n.host===s._originalHostOrSocketPath;(!p||s._originalSecure&&!o)&&(delete i.headers.authorization,delete i.headers.cookie,p||delete i.headers.host,i.auth=void 0)}i.auth&&!r.headers.authorization&&(r.headers.authorization="Basic "+Buffer.from(i.auth).toString("base64")),y=s._req=l(i),s._redirects&&s.emit("redirect",s.url,y)}else y=s._req=l(i);i.timeout&&y.on("timeout",()=>{U(s,y,"Opening handshake has timed out")}),y.on("error",p=>{y===null||y[Zr]||(y=s._req=null,Nt(s,p))}),y.on("response",p=>{let E=p.headers.location,L=p.statusCode;if(E&&i.followRedirects&&L>=300&&L<400){if(++s._redirects>i.maxRedirects){U(s,y,"Maximum redirects exceeded");return}y.abort();let w;try{w=new _s(E,e)}catch{let m=new SyntaxError(`Invalid URL: ${E}`);Nt(s,m);return}ei(s,w,t,r)}else s.emit("unexpected-response",y,p)||U(s,y,`Unexpected server response: ${p.statusCode}`)}),y.on("upgrade",(p,E,L)=>{if(s.emit("upgrade",p),s.readyState!==v.CONNECTING)return;y=s._req=null;let w=p.headers.upgrade;if(w===void 0||w.toLowerCase()!=="websocket"){U(s,E,"Invalid Upgrade header");return}let u=_o("sha1").update(f+bo).digest("base64");if(p.headers["sec-websocket-accept"]!==u){U(s,E,"Invalid Sec-WebSocket-Accept header");return}let m=p.headers["sec-websocket-protocol"],A;if(m!==void 0?d.size?d.has(m)||(A="Server sent an invalid subprotocol"):A="Server sent a subprotocol but none was requested":d.size&&(A="Server sent no subprotocol"),A){U(s,E,A);return}m&&(s._protocol=m);let C=p.headers["sec-websocket-extensions"];if(C!==void 0){if(!_){U(s,E,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");return}let M;try{M=Co(C)}catch{U(s,E,"Invalid Sec-WebSocket-Extensions header");return}let J=Object.keys(M);if(J.length!==1||J[0]!==fe.extensionName){U(s,E,"Server indicated an extension that was not requested");return}try{_.accept(M[fe.extensionName])}catch{U(s,E,"Invalid Sec-WebSocket-Extensions header");return}s._extensions[fe.extensionName]=_}s.setSocket(E,L,{allowSynchronousEvents:i.allowSynchronousEvents,generateMask:i.generateMask,maxPayload:i.maxPayload,skipUTF8Validation:i.skipUTF8Validation})}),i.finishRequest?i.finishRequest(y,s):y.end()}function Nt(s,e){s._readyState=v.CLOSING,s._errorEmitted=!0,s.emit("error",e),s.emitClose()}function No(s){return s.path=s.socketPath,Jr.connect(s)}function Lo(s){return s.path=void 0,!s.servername&&s.servername!==""&&(s.servername=Jr.isIP(s.host)?"":s.host),po.connect(s)}function U(s,e,t){s._readyState=v.CLOSING;let r=new Error(t);Error.captureStackTrace(r,U),e.setHeader?(e[Zr]=!0,e.abort(),e.socket&&!e.socket.destroyed&&e.socket.destroy(),process.nextTick(Nt,s,r)):(e.destroy(r),e.once("error",s.emit.bind(s,"error")),e.once("close",s.emitClose.bind(s)))}function Es(s,e,t){if(e){let r=Eo(e)?e.size:To(e).length;s._socket?s._sender._bufferedBytes+=r:s._bufferedAmount+=r}if(t){let r=new Error(`WebSocket is not open: readyState ${s.readyState} (${ne[s.readyState]})`);process.nextTick(t,r)}}function Ao(s,e){let t=this[R];t._closeFrameReceived=!0,t._closeMessage=e,t._closeCode=s,t._socket[R]!==void 0&&(t._socket.removeListener("data",Lt),process.nextTick(ti,t._socket),s===1005?t.close():t.close(s,e))}function Bo(){let s=this[R];s.isPaused||s._socket.resume()}function Po(s){let e=this[R];e._socket[R]!==void 0&&(e._socket.removeListener("data",Lt),process.nextTick(ti,e._socket),e.close(s[vo])),e._errorEmitted||(e._errorEmitted=!0,e.emit("error",s))}function Kr(){this[R].emitClose()}function Do(s,e){this[R].emit("message",s,e)}function Fo(s){let e=this[R];e._autoPong&&e.pong(s,!this._isServer,Qr),e.emit("ping",s)}function Io(s){this[R].emit("pong",s)}function ti(s){s.resume()}function Mo(s){let e=this[R];e.readyState!==v.CLOSED&&(e.readyState===v.OPEN&&(e._readyState=v.CLOSING,si(e)),this._socket.end(),e._errorEmitted||(e._errorEmitted=!0,e.emit("error",s)))}function si(s){s._closeTimer=setTimeout(s._socket.destroy.bind(s._socket),Oo)}function ri(){let s=this[R];this.removeListener("close",ri),this.removeListener("data",Lt),this.removeListener("end",ii),s._readyState=v.CLOSING;let e;!this._readableState.endEmitted&&!s._closeFrameReceived&&!s._receiver._writableState.errorEmitted&&(e=s._socket.read())!==null&&s._receiver.write(e),s._receiver.end(),this[R]=void 0,clearTimeout(s._closeTimer),s._receiver._writableState.finished||s._receiver._writableState.errorEmitted?s.emitClose():(s._receiver.on("error",Kr),s._receiver.on("finish",Kr))}function Lt(s){this[R]._receiver.write(s)||this.pause()}function ii(){let s=this[R];s._readyState=v.CLOSING,s._receiver.end(),this.end()}function ni(){let s=this[R];this.removeListener("error",ni),this.on("error",Qr),s&&(s._readyState=v.CLOSING,this.destroy())}});var fi=S((Oc,hi)=>{"use strict";var Tc=At(),{Duplex:Uo}=require("stream");function ai(s){s.emit("close")}function qo(){!this.destroyed&&this._writableState.finished&&this.destroy()}function ci(s){this.removeListener("error",ci),this.destroy(),this.listenerCount("error")===0&&this.emit("error",s)}function Wo(s,e){let t=!0,r=new Uo({...e,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return s.on("message",function(n,o){let a=!o&&r._readableState.objectMode?n.toString():n;r.push(a)||s.pause()}),s.once("error",function(n){r.destroyed||(t=!1,r.destroy(n))}),s.once("close",function(){r.destroyed||r.push(null)}),r._destroy=function(i,n){if(s.readyState===s.CLOSED){n(i),process.nextTick(ai,r);return}let o=!1;s.once("error",function(c){o=!0,n(c)}),s.once("close",function(){o||n(i),process.nextTick(ai,r)}),t&&s.terminate()},r._final=function(i){if(s.readyState===s.CONNECTING){s.once("open",function(){r._final(i)});return}s._socket!==null&&(s._socket._writableState.finished?(i(),r._readableState.endEmitted&&r.destroy()):(s._socket.once("finish",function(){i()}),s.close()))},r._read=function(){s.isPaused&&s.resume()},r._write=function(i,n,o){if(s.readyState===s.CONNECTING){s.once("open",function(){r._write(i,n,o)});return}s.send(i,o)},r.on("end",qo),r.on("error",ci),r}hi.exports=Wo});var ui=S((Rc,li)=>{"use strict";var{tokenChars:Vo}=Ne();function $o(s){let e=new Set,t=-1,r=-1,i=0;for(i;i<s.length;i++){let o=s.charCodeAt(i);if(r===-1&&Vo[o]===1)t===-1&&(t=i);else if(i!==0&&(o===32||o===9))r===-1&&t!==-1&&(r=i);else if(o===44){if(t===-1)throw new SyntaxError(`Unexpected character at index ${i}`);r===-1&&(r=i);let a=s.slice(t,r);if(e.has(a))throw new SyntaxError(`The "${a}" subprotocol is duplicated`);e.add(a),t=r=-1}else throw new SyntaxError(`Unexpected character at index ${i}`)}if(t===-1||r!==-1)throw new SyntaxError("Unexpected end of input");let n=s.slice(t,i);if(e.has(n))throw new SyntaxError(`The "${n}" subprotocol is duplicated`);return e.add(n),e}li.exports={parse:$o}});var Ei=S((Lc,yi)=>{"use strict";var Ho=require("events"),Bt=require("http"),{Duplex:Nc}=require("stream"),{createHash:jo}=require("crypto"),di=ms(),ye=Ke(),Go=ui(),zo=At(),{GUID:Yo,kWebSocket:Xo}=se(),Ko=/^[+/0-9A-Za-z]{22}==$/,pi=0,mi=1,gi=2,bs=class extends Ho{constructor(e,t){if(super(),e={allowSynchronousEvents:!0,autoPong:!0,maxPayload:100*1024*1024,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:zo,...e},e.port==null&&!e.server&&!e.noServer||e.port!=null&&(e.server||e.noServer)||e.server&&e.noServer)throw new TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(e.port!=null?(this._server=Bt.createServer((r,i)=>{let n=Bt.STATUS_CODES[426];i.writeHead(426,{"Content-Length":n.length,"Content-Type":"text/plain"}),i.end(n)}),this._server.listen(e.port,e.host,e.backlog,t)):e.server&&(this._server=e.server),this._server){let r=this.emit.bind(this,"connection");this._removeListeners=Jo(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(i,n,o)=>{this.handleUpgrade(i,n,o,r)}})}e.perMessageDeflate===!0&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=e,this._state=pi}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(e){if(this._state===gi){e&&this.once("close",()=>{e(new Error("The server is not running"))}),process.nextTick(et,this);return}if(e&&this.once("close",e),this._state!==mi)if(this._state=mi,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients?this.clients.size?this._shouldEmitClose=!0:process.nextTick(et,this):process.nextTick(et,this);else{let t=this._server;this._removeListeners(),this._removeListeners=this._server=null,t.close(()=>{et(this)})}}shouldHandle(e){if(this.options.path){let t=e.url.indexOf("?");if((t!==-1?e.url.slice(0,t):e.url)!==this.options.path)return!1}return!0}handleUpgrade(e,t,r,i){t.on("error",_i);let n=e.headers["sec-websocket-key"],o=e.headers.upgrade,a=+e.headers["sec-websocket-version"];if(e.method!=="GET"){Ee(this,e,t,405,"Invalid HTTP method");return}if(o===void 0||o.toLowerCase()!=="websocket"){Ee(this,e,t,400,"Invalid Upgrade header");return}if(n===void 0||!Ko.test(n)){Ee(this,e,t,400,"Missing or invalid Sec-WebSocket-Key header");return}if(a!==13&&a!==8){Ee(this,e,t,400,"Missing or invalid Sec-WebSocket-Version header",{"Sec-WebSocket-Version":"13, 8"});return}if(!this.shouldHandle(e)){tt(t,400);return}let c=e.headers["sec-websocket-protocol"],h=new Set;if(c!==void 0)try{h=Go.parse(c)}catch{Ee(this,e,t,400,"Invalid Sec-WebSocket-Protocol header");return}let f=e.headers["sec-websocket-extensions"],l={};if(this.options.perMessageDeflate&&f!==void 0){let d=new ye(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let _=di.parse(f);_[ye.extensionName]&&(d.accept(_[ye.extensionName]),l[ye.extensionName]=d)}catch{Ee(this,e,t,400,"Invalid or unacceptable Sec-WebSocket-Extensions header");return}}if(this.options.verifyClient){let d={origin:e.headers[`${a===8?"sec-websocket-origin":"origin"}`],secure:!!(e.socket.authorized||e.socket.encrypted),req:e};if(this.options.verifyClient.length===2){this.options.verifyClient(d,(_,y,p,E)=>{if(!_)return tt(t,y||401,p,E);this.completeUpgrade(l,n,h,e,t,r,i)});return}if(!this.options.verifyClient(d))return tt(t,401)}this.completeUpgrade(l,n,h,e,t,r,i)}completeUpgrade(e,t,r,i,n,o,a){if(!n.readable||!n.writable)return n.destroy();if(n[Xo])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>pi)return tt(n,503);let h=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${jo("sha1").update(t+Yo).digest("base64")}`],f=new this.options.WebSocket(null,void 0,this.options);if(r.size){let l=this.options.handleProtocols?this.options.handleProtocols(r,i):r.values().next().value;l&&(h.push(`Sec-WebSocket-Protocol: ${l}`),f._protocol=l)}if(e[ye.extensionName]){let l=e[ye.extensionName].params,d=di.format({[ye.extensionName]:[l]});h.push(`Sec-WebSocket-Extensions: ${d}`),f._extensions=e}this.emit("headers",h,i),n.write(h.concat(`\r
`).join(`\r
`)),n.removeListener("error",_i),f.setSocket(n,o,{allowSynchronousEvents:this.options.allowSynchronousEvents,maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(f),f.on("close",()=>{this.clients.delete(f),this._shouldEmitClose&&!this.clients.size&&process.nextTick(et,this)})),a(f,i)}};yi.exports=bs;function Jo(s,e){for(let t of Object.keys(e))s.on(t,e[t]);return function(){for(let r of Object.keys(e))s.removeListener(r,e[r])}}function et(s){s._state=gi,s.emit("close")}function _i(){this.destroy()}function tt(s,e,t,r){t=t||Bt.STATUS_CODES[e],r={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(t),...r},s.once("finish",s.destroy),s.end(`HTTP/1.1 ${e} ${Bt.STATUS_CODES[e]}\r
`+Object.keys(r).map(i=>`${i}: ${r[i]}`).join(`\r
`)+`\r
\r
`+t)}function Ee(s,e,t,r,i,n){if(s.listenerCount("wsClientError")){let o=new Error(i);Error.captureStackTrace(o,Ee),s.emit("wsClientError",o,t,e)}else tt(t,r,i,n)}});var Oa={};As(Oa,{activate:()=>va,deactivate:()=>Ta});module.exports=Qi(Oa);var I=x(require("vscode"));var Zt=x(Fs(),1);var j=Object.create(null);j.open="0";j.close="1";j.ping="2";j.pong="3";j.message="4";j.upgrade="5";j.noop="6";var $e=Object.create(null);Object.keys(j).forEach(s=>{$e[j[s]]=s});var He={type:"error",data:"parser error"};var je=({type:s,data:e},t,r)=>e instanceof ArrayBuffer||ArrayBuffer.isView(e)?r(t?e:"b"+Is(e,!0).toString("base64")):r(j[s]+(e||"")),Is=(s,e)=>Buffer.isBuffer(s)||s instanceof Uint8Array&&!e?s:s instanceof ArrayBuffer?Buffer.from(s):Buffer.from(s.buffer,s.byteOffset,s.byteLength),Ht;function Ms(s,e){if(s.data instanceof ArrayBuffer||ArrayBuffer.isView(s.data))return e(Is(s.data,!1));je(s,!0,t=>{Ht||(Ht=new TextEncoder),e(Ht.encode(t))})}var Ge=(s,e)=>{if(typeof s!="string")return{type:"message",data:Us(s,e)};let t=s.charAt(0);if(t==="b"){let r=Buffer.from(s.substring(1),"base64");return{type:"message",data:Us(r,e)}}return $e[t]?s.length>1?{type:$e[t],data:s.substring(1)}:{type:$e[t]}:He},Us=(s,e)=>e==="arraybuffer"?s instanceof ArrayBuffer?s:Buffer.isBuffer(s)?s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength):s.buffer:Buffer.isBuffer(s)?s:Buffer.from(s);var qs="",Ws=(s,e)=>{let t=s.length,r=new Array(t),i=0;s.forEach((n,o)=>{je(n,!1,a=>{r[o]=a,++i===t&&e(r.join(qs))})})},Vs=(s,e)=>{let t=s.split(qs),r=[];for(let i=0;i<t.length;i++){let n=Ge(t[i],e);if(r.push(n),n.type==="error")break}return r};function $s(){return new TransformStream({transform(s,e){Ms(s,t=>{let r=t.length,i;if(r<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,r);else if(r<65536){i=new Uint8Array(3);let n=new DataView(i.buffer);n.setUint8(0,126),n.setUint16(1,r)}else{i=new Uint8Array(9);let n=new DataView(i.buffer);n.setUint8(0,127),n.setBigUint64(1,BigInt(r))}s.data&&typeof s.data!="string"&&(i[0]|=128),e.enqueue(i),e.enqueue(t)})}})}var jt;function lt(s){return s.reduce((e,t)=>e+t.length,0)}function ut(s,e){if(s[0].length===e)return s.shift();let t=new Uint8Array(e),r=0;for(let i=0;i<e;i++)t[i]=s[0][r++],r===s[0].length&&(s.shift(),r=0);return s.length&&r<s[0].length&&(s[0]=s[0].slice(r)),t}function Hs(s,e){jt||(jt=new TextDecoder);let t=[],r=0,i=-1,n=!1;return new TransformStream({transform(o,a){for(t.push(o);;){if(r===0){if(lt(t)<1)break;let c=ut(t,1);n=(c[0]&128)===128,i=c[0]&127,i<126?r=3:i===126?r=1:r=2}else if(r===1){if(lt(t)<2)break;let c=ut(t,2);i=new DataView(c.buffer,c.byteOffset,c.length).getUint16(0),r=3}else if(r===2){if(lt(t)<8)break;let c=ut(t,8),h=new DataView(c.buffer,c.byteOffset,c.length),f=h.getUint32(0);if(f>Math.pow(2,21)-1){a.enqueue(He);break}i=f*Math.pow(2,32)+h.getUint32(4),r=3}else{if(lt(t)<i)break;let c=ut(t,i);a.enqueue(Ge(n?c:jt.decode(c),e)),r=0}if(i===0||i>s){a.enqueue(He);break}}}})}var Gt=4;var cr=x(de(),1);var Q=process.nextTick,D=global,Gs="nodebuffer";function zs(){return new zt}function tn(s){let e=s.split("; "),t=e[0].indexOf("=");if(t===-1)return;let r=e[0].substring(0,t).trim();if(!r.length)return;let i=e[0].substring(t+1).trim();i.charCodeAt(0)===34&&(i=i.slice(1,-1));let n={name:r,value:i};for(let o=1;o<e.length;o++){let a=e[o].split("=");if(a.length!==2)continue;let c=a[0].trim(),h=a[1].trim();switch(c){case"Expires":n.expires=new Date(h);break;case"Max-Age":let f=new Date;f.setUTCSeconds(f.getUTCSeconds()+parseInt(h,10)),n.expires=f;break;default:}}return n}var zt=class{constructor(){this._cookies=new Map}parseCookies(e){e&&e.forEach(t=>{let r=tn(t);r&&this._cookies.set(r.name,r)})}get cookies(){let e=Date.now();return this._cookies.forEach((t,r)=>{var i;((i=t.expires)===null||i===void 0?void 0:i.getTime())<e&&this._cookies.delete(r)}),this._cookies.entries()}addCookies(e){let t=[];for(let[r,i]of this.cookies)t.push(`${r}=${i.value}`);t.length&&(e.setDisableHeaderCheck(!0),e.setRequestHeader("cookie",t.join("; ")))}appendCookies(e){for(let[t,r]of this.cookies)e.append("cookie",`${t}=${r.value}`)}};function dt(s,...e){return e.reduce((t,r)=>(s.hasOwnProperty(r)&&(t[r]=s[r]),t),{})}var sn=D.setTimeout,rn=D.clearTimeout;function Z(s,e){e.useNativeTimers?(s.setTimeoutFn=sn.bind(D),s.clearTimeoutFn=rn.bind(D)):(s.setTimeoutFn=D.setTimeout.bind(D),s.clearTimeoutFn=D.clearTimeout.bind(D))}var nn=1.33;function Ys(s){return typeof s=="string"?on(s):Math.ceil((s.byteLength||s.size)*nn)}function on(s){let e=0,t=0;for(let r=0,i=s.length;r<i;r++)e=s.charCodeAt(r),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(r++,t+=4);return t}function pt(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function Xs(s){let e="";for(let t in s)s.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(s[t]));return e}function Ks(s){let e={},t=s.split("&");for(let r=0,i=t.length;r<i;r++){let n=t[r].split("=");e[decodeURIComponent(n[0])]=decodeURIComponent(n[1])}return e}var hr=x(V(),1),Rn=(0,hr.default)("engine.io-client:transport"),Et=class extends Error{constructor(e,t,r){super(e),this.description=t,this.context=r,this.type="TransportError"}},ee=class extends cr.Emitter{constructor(e){super(),this.writable=!1,Z(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,r){return super.emitReserved("error",new Et(e,t,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"?this.write(e):Rn("transport is not open, discarding packets")}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){let t=Ge(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){let e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(this.opts.port)!==443||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){let t=Xs(e);return t.length?"?"+t:""}};var fr=x(V(),1),G=(0,fr.default)("engine.io-client:polling"),ze=class extends ee{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";let t=()=>{G("paused"),this.readyState="paused",e()};if(this._polling||!this.writable){let r=0;this._polling&&(G("we are currently polling - waiting to pause"),r++,this.once("pollComplete",function(){G("pre-pause polling complete"),--r||t()})),this.writable||(G("we are currently writing - waiting to pause"),r++,this.once("drain",function(){G("pre-pause writing complete"),--r||t()}))}else t()}_poll(){G("polling"),this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){G("polling got data %s",e);let t=r=>{if(this.readyState==="opening"&&r.type==="open"&&this.onOpen(),r.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(r)};Vs(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"?this._poll():G('ignoring poll - transport state "%s"',this.readyState))}doClose(){let e=()=>{G("writing close packet"),this.write([{type:"close"}])};this.readyState==="open"?(G("transport open - closing"),e()):(G("transport not open - deferring close"),this.once("open",e))}write(e){this.writable=!1,Ws(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let e=this.opts.secure?"https":"http",t=this.query||{};return this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=pt()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.createUri(e,t)}};var pr=x(de(),1);var lr=!1;try{lr=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}var ur=lr;var mr=x(V(),1),Qt=(0,mr.default)("engine.io-client:polling");function Nn(){}var bt=class extends ze{constructor(e){if(super(e),typeof location<"u"){let t=location.protocol==="https:",r=location.port;r||(r=t?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||r!==e.port}}doWrite(e,t){let r=this.request({method:"POST",data:e});r.on("success",t),r.on("error",(i,n)=>{this.onError("xhr post error",i,n)})}doPoll(){Qt("xhr poll");let e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,r)=>{this.onError("xhr poll error",t,r)}),this.pollXhr=e}},te=class s extends pr.Emitter{constructor(e,t,r){super(),this.createRequest=e,Z(this,r),this._opts=r,this._method=r.method||"GET",this._uri=t,this._data=r.data!==void 0?r.data:null,this._create()}_create(){var e;let t=dt(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;let r=this._xhr=this.createRequest(t);try{Qt("xhr open %s: %s",this._method,this._uri),r.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let i in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(i)&&r.setRequestHeader(i,this._opts.extraHeaders[i])}}catch{}if(this._method==="POST")try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{r.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(r),"withCredentials"in r&&(r.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(r.timeout=this._opts.requestTimeout),r.onreadystatechange=()=>{var i;r.readyState===3&&((i=this._opts.cookieJar)===null||i===void 0||i.parseCookies(r.getResponseHeader("set-cookie"))),r.readyState===4&&(r.status===200||r.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof r.status=="number"?r.status:0)},0))},Qt("xhr data %s",this._data),r.send(this._data)}catch(i){this.setTimeoutFn(()=>{this._onError(i)},0);return}typeof document<"u"&&(this._index=s.requestsCount++,s.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=Nn,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete s.requests[this._index],this._xhr=null}}_onLoad(){let e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}};te.requestsCount=0;te.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",dr);else if(typeof addEventListener=="function"){let s="onpagehide"in D?"pagehide":"unload";addEventListener(s,dr,!1)}}function dr(){for(let s in te.requests)te.requests.hasOwnProperty(s)&&te.requests[s].abort()}var fc=(function(){let s=Ln({xdomain:!1});return s&&s.responseType!==null})();function Ln(s){let e=s.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||ur))return new XMLHttpRequest}catch{}if(!e)try{return new D[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}var An=Zt.default||Zt,Te=class extends bt{request(e={}){var t;return Object.assign(e,{xd:this.xd,cookieJar:(t=this.socket)===null||t===void 0?void 0:t._cookieJar},this.opts),new te(r=>new An(r),this.uri(),e)}};var Qo=x(fi(),1),Zo=x(fs(),1),ea=x(ds(),1),xs=x(At(),1),ta=x(Ei(),1);var bi=x(V(),1),ra=(0,bi.default)("engine.io-client:websocket"),ia=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative",Pt=class extends ee{get name(){return"websocket"}doOpen(){let e=this.uri(),t=this.opts.protocols,r=ia?{}:dt(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,r)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){let r=e[t],i=t===e.length-1;je(r,this.supportsBinary,n=>{try{this.doWrite(r,n)}catch{ra("websocket closed before onclose event")}i&&Q(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){let e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=pt()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}},Fc=D.WebSocket||D.MozWebSocket;var De=class extends Pt{createSocket(e,t,r){var i;if(!((i=this.socket)===null||i===void 0)&&i._cookieJar){r.headers=r.headers||{},r.headers.cookie=typeof r.headers.cookie=="string"?[r.headers.cookie]:r.headers.cookie||[];for(let[n,o]of this.socket._cookieJar.cookies)r.headers.cookie.push(`${n}=${o.value}`)}return new xs.default(e,t,r)}doWrite(e,t){let r={};e.options&&(r.compress=e.options.compress),this.opts.perMessageDeflate&&(typeof t=="string"?Buffer.byteLength(t):t.length)<this.opts.perMessageDeflate.threshold&&(r.compress=!1),this.ws.send(t,r)}};var xi=x(V(),1),st=(0,xi.default)("engine.io-client:webtransport"),Fe=class extends ee{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{st("transport closed gracefully"),this.onClose()}).catch(e=>{st("transport closed due to %s",e),this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{let t=Hs(Number.MAX_SAFE_INTEGER,this.socket.binaryType),r=e.readable.pipeThrough(t).getReader(),i=$s();i.readable.pipeTo(e.writable),this._writer=i.writable.getWriter();let n=()=>{r.read().then(({done:a,value:c})=>{if(a){st("session is closed");return}st("received chunk: %o",c),this.onPacket(c),n()}).catch(a=>{st("an error occurred while reading: %s",a)})};n();let o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){let r=e[t],i=t===e.length-1;this._writer.write(r).then(()=>{i&&Q(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}};var vs={websocket:De,webtransport:Fe,polling:Te};var na=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,oa=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Ie(s){if(s.length>8e3)throw"URI too long";let e=s,t=s.indexOf("["),r=s.indexOf("]");t!=-1&&r!=-1&&(s=s.substring(0,t)+s.substring(t,r).replace(/:/g,";")+s.substring(r,s.length));let i=na.exec(s||""),n={},o=14;for(;o--;)n[oa[o]]=i[o]||"";return t!=-1&&r!=-1&&(n.source=e,n.host=n.host.substring(1,n.host.length-1).replace(/;/g,":"),n.authority=n.authority.replace("[","").replace("]","").replace(/;/g,":"),n.ipv6uri=!0),n.pathNames=aa(n,n.path),n.queryKey=ca(n,n.query),n}function aa(s,e){let t=/\/{2,9}/g,r=e.replace(t,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&r.splice(0,1),e.slice(-1)=="/"&&r.splice(r.length-1,1),r}function ca(s,e){let t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(r,i,n){i&&(t[i]=n)}),t}var vi=x(de(),1);var Si=x(V(),1),b=(0,Si.default)("engine.io-client:socket"),Ss=typeof addEventListener=="function"&&typeof removeEventListener=="function",rt=[];Ss&&addEventListener("offline",()=>{b("closing %d connection(s) because the network was lost",rt.length),rt.forEach(s=>s())},!1);var be=class s extends vi.Emitter{constructor(e,t){if(super(),this.binaryType=Gs,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(t=e,e=null),e){let r=Ie(e);t.hostname=r.host,t.secure=r.protocol==="https"||r.protocol==="wss",t.port=r.port,r.query&&(t.query=r.query)}else t.host&&(t.hostname=Ie(t.host).host);Z(this,t),this.secure=t.secure!=null?t.secure:typeof location<"u"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=t.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(r=>{let i=r.prototype.name;this.transports.push(i),this._transportsByName[i]=r}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=Ks(this.opts.query)),Ss&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(b("adding listener for the 'offline' event"),this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},rt.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=zs()),this._open()}createTransport(e){b('creating transport "%s"',e);let t=Object.assign({},this.opts.query);t.EIO=Gt,t.transport=e,this.id&&(t.sid=this.id);let r=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return b("options: %j",r),new this._transportsByName[e](r)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}let e=this.opts.rememberUpgrade&&s.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";let t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){b("setting transport %s",e.name),this.transport&&(b("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",t=>this._onClose("transport close",t))}onOpen(){b("socket open"),this.readyState="open",s.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(b('socket receive: type "%s", data "%s"',e.type,e.data),this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":let t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}else b('packet received with socket readyState "%s"',this.readyState)}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);let e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){let e=this._getWritablePackets();b("flushing %d packets in socket",e.length),this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let r=0;r<this.writeBuffer.length;r++){let i=this.writeBuffer[r].data;if(i&&(t+=Ys(i)),r>0&&t>this._maxPayload)return b("only send %d out of %d packets",r,this.writeBuffer.length),this.writeBuffer.slice(0,r);t+=2}return b("payload size is %d (max: %d)",t,this._maxPayload),this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;let e=Date.now()>this._pingTimeoutTime;return e&&(b("throttled timer detected, scheduling connection close"),this._pingTimeoutTime=0,Q(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,r){return this._sendPacket("message",e,t,r),this}send(e,t,r){return this._sendPacket("message",e,t,r),this}_sendPacket(e,t,r,i){if(typeof t=="function"&&(i=t,t=void 0),typeof r=="function"&&(i=r,r=null),this.readyState==="closing"||this.readyState==="closed")return;r=r||{},r.compress=r.compress!==!1;let n={type:e,data:t,options:r};this.emitReserved("packetCreate",n),this.writeBuffer.push(n),i&&this.once("flush",i),this.flush()}close(){let e=()=>{this._onClose("forced close"),b("socket closing - telling transport to close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},r=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():e()}):this.upgrading?r():e()),this}_onError(e){if(b("socket error %j",e),s.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return b("trying next transport"),this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(b('socket close with reason: "%s"',e),this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Ss&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){let r=rt.indexOf(this._offlineEventListener);r!==-1&&(b("removing listener for the 'offline' event"),rt.splice(r,1))}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}};be.protocol=Gt;var Dt=class extends be{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade){b("starting upgrade probes");for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}}_probe(e){b('probing transport "%s"',e);let t=this.createTransport(e),r=!1;be.priorWebsocketSuccess=!1;let i=()=>{r||(b('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",l=>{if(!r)if(l.type==="pong"&&l.data==="probe"){if(b('probe transport "%s" pong',e),this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;be.priorWebsocketSuccess=t.name==="websocket",b('pausing current transport "%s"',this.transport.name),this.transport.pause(()=>{r||this.readyState!=="closed"&&(b("changing transport and sending upgrade packet"),f(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{b('probe transport "%s" failed',e);let d=new Error("probe error");d.transport=t.name,this.emitReserved("upgradeError",d)}}))};function n(){r||(r=!0,f(),t.close(),t=null)}let o=l=>{let d=new Error("probe error: "+l);d.transport=t.name,n(),b('probe transport "%s" failed because of error: %s',e,l),this.emitReserved("upgradeError",d)};function a(){o("transport closed")}function c(){o("socket closed")}function h(l){t&&l.name!==t.name&&(b('"%s" works - aborting "%s"',l.name,t.name),n())}let f=()=>{t.removeListener("open",i),t.removeListener("error",o),t.removeListener("close",a),this.off("close",c),this.off("upgrading",h)};t.once("open",i),t.once("error",o),t.once("close",a),this.once("close",c),this.once("upgrading",h),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{r||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){let t=[];for(let r=0;r<e.length;r++)~this.transports.indexOf(e[r])&&t.push(e[r]);return t}},Me=class extends Dt{constructor(e,t={}){let r=typeof e=="object"?e:t;(!r.transports||r.transports&&typeof r.transports[0]=="string")&&(r.transports=(r.transports||["polling","websocket","webtransport"]).map(i=>vs[i]).filter(i=>!!i)),super(e,r)}};var nh=Me.protocol;var ki=x(V(),1),wi=(0,ki.default)("socket.io-client:url");function Ci(s,e="",t){let r=s;t=t||typeof location<"u"&&location,s==null&&(s=t.protocol+"//"+t.host),typeof s=="string"&&(s.charAt(0)==="/"&&(s.charAt(1)==="/"?s=t.protocol+s:s=t.host+s),/^(https?|wss?):\/\//.test(s)||(wi("protocol-less url %s",s),typeof t<"u"?s=t.protocol+"//"+s:s="https://"+s),wi("parse %s",s),r=Ie(s)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";let n=r.host.indexOf(":")!==-1?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+n+":"+r.port+e,r.href=r.protocol+"://"+n+(t&&t.port===r.port?"":":"+r.port),r}var Ns={};As(Ns,{Decoder:()=>Os,Encoder:()=>Ts,PacketType:()=>g,isPacketValid:()=>ba,protocol:()=>Bi});var Ni=x(de(),1);var ua=typeof ArrayBuffer=="function",da=s=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(s):s.buffer instanceof ArrayBuffer,Ti=Object.prototype.toString,pa=typeof Blob=="function"||typeof Blob<"u"&&Ti.call(Blob)==="[object BlobConstructor]",ma=typeof File=="function"||typeof File<"u"&&Ti.call(File)==="[object FileConstructor]";function nt(s){return ua&&(s instanceof ArrayBuffer||da(s))||pa&&s instanceof Blob||ma&&s instanceof File}function it(s,e){if(!s||typeof s!="object")return!1;if(Array.isArray(s)){for(let t=0,r=s.length;t<r;t++)if(it(s[t]))return!0;return!1}if(nt(s))return!0;if(s.toJSON&&typeof s.toJSON=="function"&&arguments.length===1)return it(s.toJSON(),!0);for(let t in s)if(Object.prototype.hasOwnProperty.call(s,t)&&it(s[t]))return!0;return!1}function Oi(s){let e=[],t=s.data,r=s;return r.data=ws(t,e),r.attachments=e.length,{packet:r,buffers:e}}function ws(s,e){if(!s)return s;if(nt(s)){let t={_placeholder:!0,num:e.length};return e.push(s),t}else if(Array.isArray(s)){let t=new Array(s.length);for(let r=0;r<s.length;r++)t[r]=ws(s[r],e);return t}else if(typeof s=="object"&&!(s instanceof Date)){let t={};for(let r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=ws(s[r],e));return t}return s}function Ri(s,e){return s.data=ks(s.data,e),delete s.attachments,s}function ks(s,e){if(!s)return s;if(s&&s._placeholder===!0){if(typeof s.num=="number"&&s.num>=0&&s.num<e.length)return e[s.num];throw new Error("illegal attachments")}else if(Array.isArray(s))for(let t=0;t<s.length;t++)s[t]=ks(s[t],e);else if(typeof s=="object")for(let t in s)Object.prototype.hasOwnProperty.call(s,t)&&(s[t]=ks(s[t],e));return s}var Li=x(V(),1),Cs=(0,Li.default)("socket.io-parser"),Ai=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Bi=5,g;(function(s){s[s.CONNECT=0]="CONNECT",s[s.DISCONNECT=1]="DISCONNECT",s[s.EVENT=2]="EVENT",s[s.ACK=3]="ACK",s[s.CONNECT_ERROR=4]="CONNECT_ERROR",s[s.BINARY_EVENT=5]="BINARY_EVENT",s[s.BINARY_ACK=6]="BINARY_ACK"})(g||(g={}));var Ts=class{constructor(e){this.replacer=e}encode(e){return Cs("encoding packet %j",e),(e.type===g.EVENT||e.type===g.ACK)&&it(e)?this.encodeAsBinary({type:e.type===g.EVENT?g.BINARY_EVENT:g.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===g.BINARY_EVENT||e.type===g.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),Cs("encoded %j as %s",e,t),t}encodeAsBinary(e){let t=Oi(e),r=this.encodeAsString(t.packet),i=t.buffers;return i.unshift(r),i}},Os=class s extends Ni.Emitter{constructor(e){super(),this.reviver=e}add(e){let t;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);let r=t.type===g.BINARY_EVENT;r||t.type===g.BINARY_ACK?(t.type=r?g.EVENT:g.ACK,this.reconstructor=new Rs(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(nt(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0,r={type:Number(e.charAt(0))};if(g[r.type]===void 0)throw new Error("unknown packet type "+r.type);if(r.type===g.BINARY_EVENT||r.type===g.BINARY_ACK){let n=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);let o=e.substring(n,t);if(o!=Number(o)||e.charAt(t)!=="-")throw new Error("Illegal attachments");r.attachments=Number(o)}if(e.charAt(t+1)==="/"){let n=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););r.nsp=e.substring(n,t)}else r.nsp="/";let i=e.charAt(t+1);if(i!==""&&Number(i)==i){let n=t+1;for(;++t;){let o=e.charAt(t);if(o==null||Number(o)!=o){--t;break}if(t===e.length)break}r.id=Number(e.substring(n,t+1))}if(e.charAt(++t)){let n=this.tryParse(e.substr(t));if(s.isPayloadValid(r.type,n))r.data=n;else throw new Error("invalid payload")}return Cs("decoded %s as %j",e,r),r}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,t){switch(e){case g.CONNECT:return Ft(t);case g.DISCONNECT:return t===void 0;case g.CONNECT_ERROR:return typeof t=="string"||Ft(t);case g.EVENT:case g.BINARY_EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&Ai.indexOf(t[0])===-1);case g.ACK:case g.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}},Rs=class{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){let t=Ri(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}};function _a(s){return typeof s=="string"}var ga=Number.isInteger||function(s){return typeof s=="number"&&isFinite(s)&&Math.floor(s)===s};function ya(s){return s===void 0||ga(s)}function Ft(s){return Object.prototype.toString.call(s)==="[object Object]"}function Ea(s,e){switch(s){case g.CONNECT:return e===void 0||Ft(e);case g.DISCONNECT:return e===void 0;case g.EVENT:return Array.isArray(e)&&(typeof e[0]=="number"||typeof e[0]=="string"&&Ai.indexOf(e[0])===-1);case g.ACK:return Array.isArray(e);case g.CONNECT_ERROR:return typeof e=="string"||Ft(e);default:return!1}}function ba(s){return _a(s.nsp)&&ya(s.id)&&Ea(s.type,s.data)}function q(s,e,t){return s.on(e,t),function(){s.off(e,t)}}var Pi=x(de(),1),Di=x(V(),1),k=(0,Di.default)("socket.io-client:socket"),xa=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),Ue=class extends Pi.Emitter{constructor(e,t,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;let e=this.io;this.subs=[q(e,"open",this.onopen.bind(this)),q(e,"packet",this.onpacket.bind(this)),q(e,"error",this.onerror.bind(this)),q(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){var r,i,n;if(xa.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;let o={type:g.EVENT,data:t};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){let f=this.ids++;k("emitting packet with ack id %d",f);let l=t.pop();this._registerAckCallback(f,l),o.id=f}let a=(i=(r=this.io.engine)===null||r===void 0?void 0:r.transport)===null||i===void 0?void 0:i.writable,c=this.connected&&!(!((n=this.io.engine)===null||n===void 0)&&n._hasPingExpired());return this.flags.volatile&&!a?k("discard packet as the transport is not currently writable"):c?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o),this.flags={},this}_registerAckCallback(e,t){var r;let i=(r=this.flags.timeout)!==null&&r!==void 0?r:this._opts.ackTimeout;if(i===void 0){this.acks[e]=t;return}let n=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let a=0;a<this.sendBuffer.length;a++)this.sendBuffer[a].id===e&&(k("removing packet with ack id %d from the buffer",e),this.sendBuffer.splice(a,1));k("event with ack id %d has timed out after %d ms",e,i),t.call(this,new Error("operation has timed out"))},i),o=(...a)=>{this.io.clearTimeoutFn(n),t.apply(this,a)};o.withError=!0,this.acks[e]=o}emitWithAck(e,...t){return new Promise((r,i)=>{let n=(o,a)=>o?i(o):r(a);n.withError=!0,t.push(n),this.emit(e,...t)})}_addToQueue(e){let t;typeof e[e.length-1]=="function"&&(t=e.pop());let r={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((i,...n)=>r!==this._queue[0]?k("packet [%d] already acknowledged",r.id):(i!==null?r.tryCount>this._opts.retries&&(k("packet [%d] is discarded after %d tries",r.id,r.tryCount),this._queue.shift(),t&&t(i)):(k("packet [%d] was successfully sent",r.id),this._queue.shift(),t&&t(null,...n)),r.pending=!1,this._drainQueue())),this._queue.push(r),this._drainQueue()}_drainQueue(e=!1){if(k("draining queue"),!this.connected||this._queue.length===0)return;let t=this._queue[0];if(t.pending&&!e){k("packet [%d] has already been sent and is waiting for an ack",t.id);return}t.pending=!0,t.tryCount++,k("sending packet [%d] (try n\xB0%d)",t.id,t.tryCount),this.flags=t.flags,this.emit.apply(this,t.args)}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){k("transport is open - connecting"),typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:g.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){k("close (%s)",e),this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(r=>String(r.id)===e)){let r=this.acks[e];delete this.acks[e],r.withError&&r.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case g.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case g.EVENT:case g.BINARY_EVENT:this.onevent(e);break;case g.ACK:case g.BINARY_ACK:this.onack(e);break;case g.DISCONNECT:this.ondisconnect();break;case g.CONNECT_ERROR:this.destroy();let r=new Error(e.data.message);r.data=e.data.data,this.emitReserved("connect_error",r);break}}onevent(e){let t=e.data||[];k("emitting event %j",t),e.id!=null&&(k("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){let t=this._anyListeners.slice();for(let r of t)r.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){let t=this,r=!1;return function(...i){r||(r=!0,k("sending ack %j",i),t.packet({type:g.ACK,id:e,data:i}))}}onack(e){let t=this.acks[e.id];if(typeof t!="function"){k("bad ack %s",e.id);return}delete this.acks[e.id],k("calling ack %s with %j",e.id,e.data),t.withError&&e.data.unshift(null),t.apply(this,e.data)}onconnect(e,t){k("socket connected with id %s",e),this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this._drainQueue(!0),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){k("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&(k("performing disconnect (%s)",this.nsp),this.packet({type:g.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){let t=this._anyListeners;for(let r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){let t=this._anyOutgoingListeners;for(let r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){let t=this._anyOutgoingListeners.slice();for(let r of t)r.apply(this,e.data)}}};function xe(s){s=s||{},this.ms=s.min||100,this.max=s.max||1e4,this.factor=s.factor||2,this.jitter=s.jitter>0&&s.jitter<=1?s.jitter:0,this.attempts=0}xe.prototype.duration=function(){var s=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*s);s=(Math.floor(e*10)&1)==0?s-t:s+t}return Math.min(s,this.max)|0};xe.prototype.reset=function(){this.attempts=0};xe.prototype.setMin=function(s){this.ms=s};xe.prototype.setMax=function(s){this.max=s};xe.prototype.setJitter=function(s){this.jitter=s};var Fi=x(de(),1),Ii=x(V(),1),N=(0,Ii.default)("socket.io-client:manager"),qe=class extends Fi.Emitter{constructor(e,t){var r;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,Z(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((r=t.randomizationFactor)!==null&&r!==void 0?r:.5),this.backoff=new xe({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;let i=t.parser||Ns;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(N("readyState %s",this._readyState),~this._readyState.indexOf("open"))return this;N("opening %s",this.uri),this.engine=new Me(this.uri,this.opts);let t=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;let i=q(t,"open",function(){r.onopen(),e&&e()}),n=a=>{N("error"),this.cleanup(),this._readyState="closed",this.emitReserved("error",a),e?e(a):this.maybeReconnectOnOpen()},o=q(t,"error",n);if(this._timeout!==!1){let a=this._timeout;N("connect attempt will timeout after %d",a);let c=this.setTimeoutFn(()=>{N("connect attempt timed out after %d",a),i(),n(new Error("timeout")),t.close()},a);this.opts.autoUnref&&c.unref(),this.subs.push(()=>{this.clearTimeoutFn(c)})}return this.subs.push(i),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){N("open"),this.cleanup(),this._readyState="open",this.emitReserved("open");let e=this.engine;this.subs.push(q(e,"ping",this.onping.bind(this)),q(e,"data",this.ondata.bind(this)),q(e,"error",this.onerror.bind(this)),q(e,"close",this.onclose.bind(this)),q(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){Q(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){N("error",e),this.emitReserved("error",e)}socket(e,t){let r=this.nsps[e];return r?this._autoConnect&&!r.active&&r.connect():(r=new Ue(this,e,t),this.nsps[e]=r),r}_destroy(e){let t=Object.keys(this.nsps);for(let r of t)if(this.nsps[r].active){N("socket %s is still active, skipping close",r);return}this._close()}_packet(e){N("writing packet %j",e);let t=this.encoder.encode(e);for(let r=0;r<t.length;r++)this.engine.write(t[r],e.options)}cleanup(){N("cleanup"),this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){N("disconnect"),this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var r;N("closed due to %s",e),this.cleanup(),(r=this.engine)===null||r===void 0||r.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;let e=this;if(this.backoff.attempts>=this._reconnectionAttempts)N("reconnect failed"),this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{let t=this.backoff.duration();N("will wait %dms before reconnect attempt",t),this._reconnecting=!0;let r=this.setTimeoutFn(()=>{e.skipReconnect||(N("attempting reconnect"),this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(i=>{i?(N("reconnect attempt error"),e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",i)):(N("reconnect success"),e.onreconnect())}))},t);this.opts.autoUnref&&r.unref(),this.subs.push(()=>{this.clearTimeoutFn(r)})}}onreconnect(){let e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}};var Ui=x(V(),1),Mi=(0,Ui.default)("socket.io-client"),ot={};function at(s,e){typeof s=="object"&&(e=s,s=void 0),e=e||{};let t=Ci(s,e.path||"/socket.io"),r=t.source,i=t.id,n=t.path,o=ot[i]&&n in ot[i].nsps,a=e.forceNew||e["force new connection"]||e.multiplex===!1||o,c;return a?(Mi("ignoring socket cache for %s",r),c=new qe(r,e)):(ot[i]||(Mi("new io instance for %s",r),ot[i]=new qe(r,e)),c=ot[i]),t.query&&!e.query&&(e.query=t.queryKey),c.socket(t.path,e)}Object.assign(at,{Manager:qe,Socket:Ue,io:at,connect:at});var Y,ct,ve,oe={sidebar:!0,auxbar:!1,panel:!0,zen:!1};function va(s){console.log("VS Flick is active"),ct=I.window.createStatusBarItem(I.StatusBarAlignment.Right,100),ct.command="vs-flick.showMenu",s.subscriptions.push(ct),It("Offline"),ct.show(),s.subscriptions.push(I.commands.registerCommand("vs-flick.start",()=>wa()),I.commands.registerCommand("vs-flick.stop",qi),I.commands.registerCommand("vs-flick.showMenu",Sa))}function It(s){ct.text=`$(broadcast) Flick: ${s}`}async function Sa(){let s=[];Y?(s.push({label:"Stop Server",description:`Disconnect (Code: ${ve})`,command:"vs-flick.stop"}),s.push({label:"Resync State",description:"Force update PWA state",command:"vs-flick.resync"})):s.push({label:"Start Server",description:"Connect to Relay Server",command:"vs-flick.start"});let e=await I.window.showQuickPick(s);e&&e.command&&I.commands.executeCommand(e.command)}async function wa(){let s="http://localhost:3000";try{Y=at(s),Y.on("connect",()=>{console.log("Connected to Relay Server"),Y?.emit("create_session",e=>{e&&e.code&&(ve=e.code,It(`${ve}`),I.window.showInformationMessage(`VS Flick Paired! Code: ${ve}`),Ls())})}),Y.on("pwa_connected",()=>{I.window.showInformationMessage("Phone Connected!"),Ls()}),Y.on("command",async e=>{let t=e.action,r=ka(t);r&&(await I.commands.executeCommand(r),Ca(t),Ls())}),Y.on("disconnect",()=>{It("Disconnected")})}catch(e){I.window.showErrorMessage(`Failed to connect to VS Flick Server: ${e}`)}}function qi(){Y?.disconnect(),Y=void 0,ve=void 0,It("Offline")}function ka(s){return{sidebar:"workbench.action.toggleSidebarVisibility",auxbar:"workbench.action.toggleAuxiliaryBar",panel:"workbench.action.togglePanel",zen:"workbench.action.toggleZenMode"}[s]}function Ca(s){s==="sidebar"&&(oe.sidebar=!oe.sidebar),s==="auxbar"&&(oe.auxbar=!oe.auxbar),s==="panel"&&(oe.panel=!oe.panel),s==="zen"&&(oe.zen=!oe.zen)}function Ls(){Y&&ve&&Y.emit("status",{code:ve,state:oe})}function Ta(){qi()}0&&(module.exports={activate,deactivate});
/*! Bundled license information:

xmlhttprequest-ssl/lib/XMLHttpRequest.js:
  (**
   * Wrapper for built-in http.js to emulate the browser XMLHttpRequest object.
   *
   * This can be used with JS designed for browsers to improve reuse of code and
   * allow the use of existing libraries.
   *
   * Usage: include("XMLHttpRequest.js") and use XMLHttpRequest per W3C specs.
   *
   * @author Dan DeFelippi <dan@driverdan.com>
   * @contributor David Ellis <d.f.ellis@ieee.org>
   * @license MIT
   *)
*/
